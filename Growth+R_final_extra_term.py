# -*- coding: utf-8 -*-
"""
Created on Mon May 23 18:26:15 2022

@author: Manos
"""

import time 
import numpy as np
from scipy.integrate import quad,solve_ivp
from numpy import sqrt, pi
import pylab as pp
from pymaxent import moments_c,maxent_reconstruct_c0_1,maxent_reconstruct_c1_1,maxent_reconstruct_c0_2,maxent_reconstruct_c1_2,temp1,temp2
from plyer import notification

start = time.time()

''' Σταθερές Αδιαστατοποίησης'''
Lr = 100e-6 
tr = 3600
Tr = 273
scale = 1e4

'''Constants'''
a0 = 3.5e-4
kv = pi/6 
dens = 1300
q0 = 400
q1 = 2500
kr0 = 1e11
Er = 75000

Sd0 = Sl0 = 1
lmeand0 = lmeanl0 = 0.5
σd0 = σl0 = 0.025

m3d0 = 0.062806
ratio = 1.5
m3l0 = m3d0/ratio

Eg = Ed = 12000
R = 8.314

T = 308

kb = 0.001
kg = 1e-4
kd = 2e-4

Kg = tr/Lr * kg*np.exp(-Eg/(R*T))
Kd = tr/Lr * kd*np.exp(-Ed/(R*T))
Kbg = kb*tr

'''Απόλυτο και σχετικό σφάλμα ολοκλήρωσης'''
tol1 = 1e-5 #absolute error
tol2 = 1e-4 #relative error


'''Αρχικοποίση των μεταβλητών'''
tspan=(0, 30)
resolution = 150
teval = np.linspace(tspan[0],tspan[1],resolution+1)


def f0_d(λ):
    return ( m3d0*lmeand0*(lmeand0**2+3*σd0**2)/(sqrt(2*pi*σd0)) * np.exp(-(λ-lmeand0)**2/(2*σd0**2)) )*scale 
def f0_l(λ):
    return ( m3l0*lmeanl0*(lmeanl0**2+3*σl0**2)/(sqrt(2*pi*σl0)) * np.exp(-(λ-lmeanl0)**2/(2*σl0**2)) )*scale 

initial_m_d = moments_c(f0_d, k=4, bnds=[0, np.inf])
initial_m_l = moments_c(f0_l, k=4, bnds=[0, np.inf])

initial_values = [*initial_m_d, *initial_m_l, Sd0, Sl0]

print("\033[1;36m"+'Initial moments (D)=',initial_m_d,'\nInitial moments (L)=',initial_m_d,'\033[39m')

ee0 = ( initial_m_d[3] - initial_m_l[3] ) / ( initial_m_d[3] + initial_m_l[3] )

def cinf_d(T): return( q0*np.exp(-q1/T) )
def cinf_l(T): return( q0*np.exp(-q1/T) )

def γ_d(T): return( cinf_d(T)/(Lr**3*kv*dens) )
def γ_l(T): return( cinf_l(T)/(Lr**3*kv*dens) )


'''Growth Term'''
def G_d(Sd,T,L):
    if L<1e-3: return(0)
    else:
        jd =  Sd-1-a0/(L*Lr*T)
        if jd>0: 
            result = Kg * jd 
            return result
        else: 
            result = Kd * jd 
            return result

def G_l(Sl,T,L):
    if L<1e-3: return(0)
    else:
        jl =  Sl-1-a0/(L*Lr*T)
        if jl>0: 
            result = Kg * jl 
            return result
        else: 
            result = Kd * jl 
            return result

'''Racemization rate'''
def Rd(Sl,Sd,T):
    return( tr*kr0*np.exp(-Er/(R*T))*(Sl - Sd) )
def Rl(Sd,Sl,T):
    return( tr*kr0*np.exp(-Er/(R*T))*(Sd - Sl) )

'''t=0'''

Lmeand0 = initial_m_d[1]/initial_m_d[0]
sigmad0 = np.sqrt( np.abs(initial_m_d[2]-2*Lmeand0*initial_m_d[1]+lmeand0**2*initial_m_d[0])/initial_m_d[0] )

Lmeanl0 = initial_m_l[1]/initial_m_l[0]
sigmal0 = np.sqrt( np.abs(initial_m_l[2]-2*Lmeanl0*initial_m_l[1]+lmeanl0**2*initial_m_l[0])/initial_m_l[0] )

lmind = Lmeand0 - 12*sigmad0
lmaxd = Lmeand0 + 12*sigmad0

lminl = Lmeanl0 - 12*sigmal0
lmaxl = Lmeanl0 + 12*sigmal0

L=np.linspace(0,1,1000)

pp.figure(6)

mu0_d=[initial_m_d[0],initial_m_d[1],initial_m_d[2],initial_m_d[3]]
sol0_d, lambdas0_d=maxent_reconstruct_c0_1(mu=mu0_d,bnds=[lmind,lmaxd])

mu0_l=[initial_m_l[0],initial_m_l[1],initial_m_l[2],initial_m_l[3]]
sol0_l, lambdas0_l=maxent_reconstruct_c0_2(mu=mu0_l,bnds=[lminl,lmaxl])

pp.plot(L,sol0_d(L),'-b',L,sol0_l(L),'-g')
pp.title('t = 0')
pp.xlabel('λ (-)',{"fontsize":16})
pp.ylabel('n #/mLμL',{"fontsize":16})

'''Επίλυση του συστήματος διαφορικών εξισώσεων'''
def moments(t,y):
    m0_d=y[0]
    m1_d=y[1]
    m2_d=y[2]
    m3_d=y[3]
    m0_l=y[4]
    m1_l=y[5]
    m2_l=y[6]
    m3_l=y[7]
    Sd=y[8]
    Sl=y[9]

    print("\033[1;31m" + '''current time is''',t,'''min/''',tspan[1],'''s''')
    
    eet1 = (m3_d-m3_l)/(m3_d+m3_l)
    print('\033[32m'+'''enantiomeric excess is''',eet1)
    print('\033[39m')
    
    Lmean_d = np.abs(m1_d/m0_d)
    σd = np.sqrt( np.abs(m2_d-2*Lmean_d*m1_d+Lmean_d**2*m0_d)/m0_d )
    Lmean_l=m1_l/m0_l
    σl=np.sqrt( np.abs(m2_l-2*Lmean_l*m1_l+Lmean_l**2*m0_l)/m0_l )
    
    Lmin_d = max(0.25,Lmean_d - 4*σd)
    Lmax_d = Lmean_d + 5*σd
    Lmin_l = max(0.25,Lmean_l - 4*σl)
    Lmax_l = Lmean_l + 5*σl

    bnds_d=[Lmin_d,Lmax_d] 
    sol_d, lambdas_d= maxent_reconstruct_c1_1(mu=y[0:4] ,bnds=bnds_d)
    bnds_l=[Lmin_l,Lmax_l]
    sol_l, lambdas_l= maxent_reconstruct_c1_2(mu=y[4:8] ,bnds=bnds_l)
    
    
    def h_d(l,k):
        return l**k*sol_d(l)*G_d(Sd,T,l)
    def h_l(l,k):
        return l**k*sol_l(l)*G_l(Sl,T,l)
    
    def momd(l,Sd,T,k):
        result = k*l**(k-1)*G_d(Sd,T,l)*sol_d(l)
        return result 
    def moml(l,Sl,T,k):
        result = k*l**(k-1)*G_l(Sl,T,l)*sol_l(l)
        return result 
        
    k = 0
    dm0dt_d = quad(momd,bnds_d[0],bnds_d[1],epsabs=tol1,epsrel=tol2,args=(Sd,T,k))[0] - ( h_d(bnds_d[1],k) - h_d(bnds_d[0],k) )
    dm0dt_l = quad(moml,bnds_l[0],bnds_l[1],epsabs=tol1,epsrel=tol2,args=(Sl,T,k))[0] - ( h_l(bnds_l[1],k) - h_l(bnds_l[0],k) )

    k = 1
    dm1dt_d = quad(momd,bnds_d[0],bnds_d[1],epsabs=tol1,epsrel=tol2,args=(Sd,T,k))[0] - ( h_d(bnds_d[1],k) - h_d(bnds_d[0],k) )
    dm1dt_l = quad(moml,bnds_l[0],bnds_l[1],epsabs=tol1,epsrel=tol2,args=(Sl,T,k))[0] - ( h_l(bnds_l[1],k) - h_l(bnds_l[0],k) )
    
    k=2
    dm2dt_d = quad(momd,bnds_d[0],bnds_d[1],epsabs=tol1,epsrel=tol2,args=(Sd,T,k))[0] - ( h_d(bnds_d[1],k) - h_d(bnds_d[0],k) )
    dm2dt_l = quad(moml,bnds_l[0],bnds_l[1],epsabs=tol1,epsrel=tol2,args=(Sl,T,k))[0] - ( h_l(bnds_l[1],k) - h_l(bnds_l[0],k) )
    
    k=3
    dm3dt_d = quad(momd,bnds_d[0],bnds_d[1],epsabs=tol1,epsrel=tol2,args=(Sd,T,k))[0] - ( h_d(bnds_d[1],k) - h_d(bnds_d[0],k) )
    dm3dt_l = quad(moml,bnds_l[0],bnds_l[1],epsabs=tol1,epsrel=tol2,args=(Sl,T,k))[0] - ( h_l(bnds_l[1],k) - h_l(bnds_l[0],k) )

    dSddt = -1/(scale*Lr**3*γ_d(T))*dm3dt_d + Rd(Sd,Sl,T)
    dSldt = -1/(scale*Lr**3*γ_l(T))*dm3dt_l + Rl(Sd,Sl,T)
    
    print('bnds_d = ',bnds_d)
    print('bnds_l = ',bnds_l)
    print('Lmean d,l = ',Lmean_d,Lmean_l)
    print('[dm0dt_d,dm0dt_l] =',[dm0dt_d,dm0dt_l])
    
    return(dm0dt_d,dm1dt_d,dm2dt_d,dm3dt_d,dm0dt_l,dm1dt_l,dm2dt_l,dm3dt_l,dSddt,dSldt)


r = solve_ivp(moments ,tspan, initial_values, method='BDF', t_eval=teval, jac=None, rtol=1e-3)


'''End of script notification'''

message= 'Script has finished running'
notification.notify(message= message,
                    app_icon = None,
                    timeout= 10,
                    toast=False)
end=time.time()
print('''total time is ''', (end-start)/60, '''min''')


'''Σύγκριση με δεδομένα από μοντέλο Comsol'''

m0c_d = [12.506224114678643		,
 12.506181956844488       ,
 12.407828140813068       ,
 11.578397832279881       ,
 10.27976202148892        ,
 9.159263291185477        ,
 8.369584200016995        ,
 7.571910473608932        ,
 6.672009782258624        ,
 5.887240922481003        ,
 5.23502671120609         ,
 4.664156970164889        ,
 4.153041824861737        ,
 3.7139117913382913       ,
 3.3400401013721064       ,
 3.0192222359899334       ,
 2.7411082373811033       ,
 2.498871723867347        ,
 2.2878876814073226       ,
 2.10319428400294         ,
 1.9406059537594478       ,
 1.7966865159591285       ,
 1.668809633423234        ,
 1.5544176329685788       ,
 1.451860091685875        ,
 1.359447229526938        ,
 1.2762159646951032       ,
 1.2008523194406666       ,
 1.1324369189813492       ,
 1.070098328288077        ,
 1.0131486662874873       ,
 0.9609003737423251       ,
 0.9128563899382186       ,
 0.868608789292584        ,
 0.8276994058454442       ,
 0.7898345234776466       ,
 0.7546738679455206       ,
 0.7219638955285541       ,
 0.691490585324417        ,
 0.6631301430981588       ,
 0.6366246717804072       ,
 0.6118097162698224       ,
 0.5885426631084426       ,
 0.5667036352961485       ,
 0.5460996570102885       ,
 0.5267248544627773       ,
 0.5084366061389448       ,
 0.4911779879215488       ,
 0.4748579716657821       ,
 0.45941310752702175      ,
 0.444786367834306        ,
 0.43092929932503643      ,
 0.41774239606364744      ,
 0.405229024057476        ,
 0.39329586206939         ,
 0.38194462014876973      ,
 0.3711177139056409       ,
 0.36078446263926567      ,
 0.3509155938214474       ,
 0.3414986024650193       ,
 0.3324792904911093       ,
 0.3238603244586005       ,
 0.3156039698752468       ,
 0.307696457435669        ,
 0.30012849961849614      ,
 0.2928530035153005       ,
 0.2858732601668165       ,
 0.27916756206817833      ,
 0.2727129435905215       ,
 0.26650202920751564      ,
 0.26052626374855553      ,
 0.2547717324612836       ,
 0.2492198321494592       ,
 0.24386896644032457      ,
 0.23871074177488488      ,
 0.23373094326755192      ,
 0.22892194058189902      ,
 0.22427297835917817      ,
 0.21978309810471727      ,
 0.21544132015479245      ,
 0.21123432230209752      ,
 0.2071660662402397       ,
 0.20322797572960688      ,
 0.19941057842291865      ,
 0.19571634829019705      ,
 0.1921310139503613       ,
 0.18865816857925824      ,
 0.18528871131715607      ,
 0.18201470487288524      ,
 0.17883876247215244      ,
 0.17575374943137168      ,
 0.172754389011693        ,
 0.16983856394247257      ,
 0.16700668095075866      ,
 0.16424971759892912      ,
 0.1615698782680645       ,
 0.15895995135337182      ,
 0.15641994255618677      ,
 0.15394830842798293      ,
 0.15154122582781188      ,
 0.14920534194442597      ,
0.1469215284940336        ,
0.14470247305390865       ,
0.14253443392319307       ,
0.14041982476462186       ,
0.13835747787111596       ,
0.13634528922388361       ,
0.134381507312372         ,
0.13246603504020585       ,
0.13059558141870828       ,
0.12876910811794495       ,
0.12698442568370044       ,
0.12524012100764897       ,
0.1235428299242805        ,
0.1218766049967616        ,
0.12024723951990214       ,
0.1186543265892789        ,
0.11710202250652044       ,
0.11557702462122398       ,
0.11408552939365703       ,
0.11262997459132498       ,
0.11120571443624061       ,
0.1098083557569361        ,
0.10844092239325102       ,
0.10709932300877262       ,
0.10578499507196833       ,
0.10450178424116462       ,
0.1032441164722453        ,
0.10201191536776395       ,
0.10080273957141431       ,
0.09961513408297393       ,
0.09845259029438742       ,
0.09731024384515914       ,
0.09619107225971218       ,
0.09509626292588072       ,
0.09401757864020534       ,
0.09296277852774401       ,
0.09192760037427208       ,
0.09090908803410527       ,
0.08991336493270101       ,
0.08893332225647899       ,
0.08797138858527022       ,
0.08702861636195057       ,
0.08610024025678091       ,
0.08518845559901549       ,
0.08429385918113366       ,
0.0834151238715371        ,
0.08255057239037338       ,
0.08170065545400802       ,
0.08086715917407154       ,
0.08004663660746546       ]
m0c_l = [8.337482743119095  		,
 8.337450452038231        ,
 8.266474459227528        ,
 7.681622451202547        ,
 6.790921530037832        ,
 6.035520453250867        ,
 5.506153684603004        ,
 4.971655051948868        ,
 4.374270820429978        ,
 3.8553187831542055       ,
 3.4244562992406906       ,
 3.04770074742572         ,
 2.711371643133931        ,
 2.423173891840654        ,
 2.1786703574370203       ,
 1.969357226510531        ,
 1.7880261248436993       ,
 1.6302161543229594       ,
 1.4929521691782206       ,
 1.3729764679787313       ,
 1.267470786090032        ,
 1.174168897222617        ,
 1.091364189476841        ,
 1.0173358056468966       ,
 0.9509446240659302       ,
 0.8910798009688575       ,
 0.8371057185550301       ,
 0.7881698622396626       ,
 0.7436849411841311       ,
 0.7030964265583035       ,
 0.6659866902405921       ,
 0.6319288070306563       ,
 0.600596742618003        ,
 0.5717256131342012       ,
 0.5450215370703945       ,
 0.5202958872785317       ,
 0.4973292431588759       ,
 0.47595842073281547      ,
 0.45604656504724983      ,
 0.43751249400380154      ,
 0.42018535815715274      ,
 0.40395717400552456      ,
 0.38873650006033494      ,
 0.3744483249150971       ,
 0.36096857915070996      ,
 0.3482924420305111       ,
 0.336324080649942        ,
 0.32502419727200216      ,
 0.3143331327422872       ,
 0.3042104786632641       ,
 0.2946202455779821       ,
 0.28553157628765485      ,
 0.2768795037016057       ,
 0.268666263366412        ,
 0.2608317057980336       ,
 0.25337762814240666      ,
 0.24626670087887823      ,
 0.23947838778375163      ,
 0.232992348215622        ,
 0.22679852543899065      ,
 0.22085995374621187      ,
 0.2151769282900294       ,
 0.20972488499150005      ,
 0.20449562246432984      ,
 0.19948450861005515      ,
 0.19466267942772594      ,
 0.19003374004974707      ,
 0.18558504057044942      ,
 0.18130268382110845      ,
 0.17718235102275207      ,
 0.17321864732622444      ,
 0.1694022517802104       ,
 0.16572072564375426      ,
 0.162172933337964        ,
 0.15875318356866538      ,
 0.15545199966570683      ,
 0.15226418542699846      ,
 0.1491824748809918       ,
 0.14620601380733797      ,
 0.14332727606030696      ,
 0.14053723770446985      ,
 0.13783828652777166      ,
 0.13522475202613235      ,
 0.1326905842986481       ,
 0.13023771620269556      ,
 0.127857089089569        ,
 0.12555143992183213      ,
 0.12331493761281502      ,
 0.1211424263563122       ,
 0.11903572140467415      ,
 0.11699007679801235      ,
 0.1150019876161308       ,
 0.11307000762699318      ,
 0.11119431255976991      ,
 0.10936867923759037      ,
 0.10759429025406085      ,
 0.10586602606112255      ,
 0.10418353323450193      ,
 0.10254548885124344      ,
 0.10094918371230452      ,
 0.09939880758518453      ,
 0.0978820320824463        ,
0.09640716858228031       ,
0.09496545565320812       ,
0.09355861103234592       ,
0.09218602719493676       ,
0.09084646624307274       ,
0.08953888170909205       ,
0.08826331799631981       ,
0.08701768768983721       ,
0.08580137326565764       ,
0.08461298066309167       ,
0.08345162475781531       ,
0.08232179848597129       ,
0.08121286322332287       ,
0.08012871889818411       ,
0.07906909114002414       ,
0.07803672652013646       ,
0.07702268586128558       ,
0.07603109048127567       ,
0.07506353548428019       ,
0.07411686605127482       ,
0.07318817056906156       ,
0.07227944799699648       ,
0.07138798014283813       ,
0.07051473277576654       ,
0.06966228315603758       ,
0.06882689032558083       ,
0.06800850388304697       ,
0.06720545864175423       ,
0.06641678071548582       ,
0.0656447419071662        ,
0.06488609584692766       ,
0.06414276479286776       ,
0.06341549959169163       ,
0.06269885780739795       ,
0.06199793113517686       ,
0.06130990383572166       ,
0.06063284042653064       ,
0.0599707562132611        ,
0.059318978506927356      ,
0.05867911024543017       ,
0.05805184447810968       ,
0.05743405830163492       ,
0.05682720199090221       ,
0.05623167521892325       ,
0.055646617523446566      ,
0.055070919826579995      ,
0.054504884822965664      ,
0.05394969178831734       ,
0.0534030708709496		]
m1c_d = [ 6.249519807988738			,
  6.171393551419826         ,
  6.05823347216724          ,
  5.706861516097941         ,
  5.2583578003138065        ,
  4.876178854729256         ,
  4.568540260228873         ,
  4.228044327518862         ,
  3.870832930062347         ,
  3.5535218629443897        ,
  3.275203074033131         ,
  3.021207713686355         ,
  2.7904863023556152        ,
  2.5864217943728707        ,
  2.406817796610461         ,
  2.247196045136918         ,
  2.1046975396704672        ,
  1.9772380281804642        ,
  1.8631494811473235        ,
  1.7604362631483228        ,
  1.6676230493727582        ,
  1.5832817324140542        ,
  1.5065297325356188        ,
  1.4362772797385208        ,
  1.3719380954417177        ,
  1.3127763473072023        ,
  1.258421685470621         ,
  1.2081749933089594        ,
  1.161632885595867         ,
  1.1184158029479034        ,
  1.0782323469388189        ,
  1.0406594332397274        ,
  1.0055265097254742        ,
  0.9726337383186505        ,
  0.9417210266822864        ,
  0.9126794354623244        ,
  0.8852978125469314        ,
  0.8594533462213928        ,
  0.8350322262020377        ,
  0.8120408191578413        ,
  0.7902740230291189        ,
  0.7695633603298409        ,
  0.7498998223866341        ,
  0.7312210569287984        ,
  0.7133472067309408        ,
  0.6963734030542863        ,
  0.680157877962373         ,
  0.6646863213246439        ,
  0.64988474850929          ,
  0.6357141058066592        ,
  0.6221573291778336        ,
  0.6091348560641983        ,
  0.5966464531555785        ,
  0.5847015119645597        ,
  0.5731812996281443        ,
  0.5621077361386602        ,
  0.5514432603382887        ,
  0.5411729796072171        ,
  0.531286303132909         ,
  0.5217526740942235        ,
  0.5125579554543307        ,
  0.5036765912117742        ,
  0.49508587449018304       ,
  0.4868009119397237        ,
  0.4787944378924258        ,
  0.47104288218270846       ,
  0.46353790963914954       ,
  0.45627901894746686       ,
  0.4492246810592263        ,
  0.44239126833131676       ,
  0.4357630682013608        ,
  0.42933626467592984       ,
  0.4230856707926049        ,
  0.4170194861667695        ,
  0.4111349795324654        ,
  0.405404052642685         ,
  0.3998358193726474        ,
  0.39441335715082293       ,
  0.3891417614653559        ,
  0.384013736763531         ,
  0.3790060072867531        ,
  0.374129834110382         ,
  0.3693863244887999        ,
  0.3647531036406796        ,
  0.3602408411675037        ,
  0.35583591324549585       ,
  0.35153877757891366       ,
  0.3473487190651443        ,
  0.343248874161036         ,
  0.3392474335669984        ,
  0.3353425560007114        ,
  0.3315218250379518        ,
  0.32778691503482266       ,
  0.3241411819021206        ,
  0.3205755315858908        ,
  0.31709347979983504       ,
  0.3136765341116077        ,
  0.31033376179217176       ,
  0.3070630427241126        ,
  0.30386098368673403       ,
  0.3007436415978914        ,
0.29767399733602395       ,
0.2946758861621019        ,
0.2917354371128664        ,
0.2888515577672197        ,
0.28602409594587597       ,
0.28325121798523706       ,
0.28053124586673733       ,
0.2778647141214592        ,
0.27524786883064395       ,
0.2726797115855963        ,
0.2701584458118051        ,
0.26768279109645804       ,
0.26527846071919003       ,
0.262894345717116         ,
0.26055084000576273       ,
0.2582491773555783        ,
0.25600754299725087       ,
0.2537911946188502        ,
0.2516083048909357        ,
0.2494619945005482        ,
0.2473694821720565        ,
0.2452958648657992        ,
0.24326216029351805       ,
0.24125678476167647       ,
0.23928362174660728       ,
0.2373456906207207        ,
0.23544853784828737       ,
0.23357040860467787       ,
0.23172684263606436       ,
0.2299033577671297        ,
0.2281166327288081        ,
0.22635047726885285       ,
0.224615948766261         ,
0.2229171545360255        ,
0.22123733314990868       ,
0.21958058235750222       ,
0.21796368884292458       ,
0.21635560283517602       ,
0.21477572093340055       ,
0.21322503862884407       ,
0.21168773094586166       ,
0.21018149131302805       ,
0.20869054341572404       ,
0.20721367357214834       ,
0.20577121693541564       ,
0.2043398268651065        ,
0.20292896594236612       ,
0.20153754117602898       ,
0.20017311084417416       ,
0.19882166311036614       ]
m1c_l = [ 4.166304536340034			,
  4.099250950971739         ,
  4.016902386600081         ,
  3.7701439477213574        ,
  3.4635401830308354        ,
  3.205958409022462         ,
  2.9995896040006893        ,
  2.7720257819233014        ,
  2.5352348610512805        ,
  2.325556868103372         ,
  2.1418691501661726        ,
  1.9745904192123267        ,
  1.823135773873165         ,
  1.6896076750106985        ,
  1.5724401483907526        ,
  1.4685114779097688        ,
  1.3758137344110373        ,
  1.2930000064373044        ,
  1.2189905598365232        ,
  1.1524511569802391        ,
  1.0923832302385024        ,
  1.0378448198139718        ,
  0.9882442927856296        ,
  0.9428403312455104        ,
  0.9012254044859531        ,
  0.8629226797954724        ,
  0.8276854067335891        ,
  0.7950716666717196        ,
  0.7648259030499336        ,
  0.7367139366524479        ,
  0.7105604366699448        ,
  0.6860972659600093        ,
  0.6632115838007616        ,
  0.6417760198416665        ,
  0.6216237506406349        ,
  0.6026850104089733        ,
  0.5848239953653775        ,
  0.5679625980271623        ,
  0.5520266826827539        ,
  0.5370193236417778        ,
  0.5228057610644917        ,
  0.5092788317755685        ,
  0.49643170259753133       ,
  0.48422608213591717       ,
  0.4725439655910318        ,
  0.461447298644244         ,
  0.450839657810482         ,
  0.44071368880645184       ,
  0.43102105893486514       ,
  0.4217370813078721        ,
  0.41285148886108325       ,
  0.4043118193314277        ,
  0.3961183199318064        ,
  0.3882771815971518        ,
  0.3807121792266324        ,
  0.37343662342056805       ,
  0.36642588998896075       ,
  0.3596694960502013        ,
  0.3531600002943286        ,
  0.3468763533562332        ,
  0.3408091540745985        ,
  0.3349420284315358        ,
  0.3292607214882982        ,
  0.32377670631061384       ,
  0.3184732496098394        ,
  0.313336736391989         ,
  0.3083622257634056        ,
  0.30355011369957347       ,
  0.29887452234654394       ,
  0.2943456596549567        ,
  0.28995294499640123       ,
  0.2856941470276101        ,
  0.2815524148119524        ,
  0.2775329780156669        ,
  0.2736337746319029        ,
  0.26983643260341617       ,
  0.2661466718593098        ,
  0.2625532177026062        ,
  0.2590590570296359        ,
  0.25565951281417554       ,
  0.25233939563543256       ,
  0.24910579015917303       ,
  0.2459596170218712        ,
  0.2428865683627698        ,
  0.23989368352886917       ,
  0.2369723976678121        ,
  0.23412300632237387       ,
  0.2313449183119137        ,
  0.22862746165668998       ,
  0.2259756487924009        ,
  0.2233880596075735        ,
  0.22085652018343394       ,
  0.21838201948038827       ,
  0.2159664522698167        ,
  0.21360351959458163       ,
  0.21129538437472828       ,
  0.2090298940705674        ,
  0.20681246880256982       ,
  0.2046417221017929        ,
  0.2025155465062999        ,
  0.2004444286661759        ,
  0.19840424041899504       ,
0.19641084535439468       ,
0.19445532743930868       ,
0.19253705006287392       ,
0.19065607935053766       ,
0.18881131780613938       ,
0.18700176199405386       ,
0.18522779877185855       ,
0.1834870384368727        ,
0.18177887905873036       ,
0.18010211423751685       ,
0.17845589941779375       ,
0.17685722592549372       ,
0.17527253685402008       ,
0.17371494480903138       ,
0.17218538544991543       ,
0.17069576876492143       ,
0.1692233118980716        ,
0.1677730273842902        ,
0.16634723972186993       ,
0.16495708033611858       ,
0.16357984160015066       ,
0.16222891711091042       ,
0.16089688059054633       ,
0.15958628591316082       ,
0.1582991261087178        ,
0.15703894828444348       ,
0.15579144647308488       ,
0.15456670952174145       ,
0.153355566817673         ,
0.15216826832468694       ,
0.15099480329410936       ,
0.14984191770558525       ,
0.14871258584169847       ,
0.14759584602800216       ,
0.14649419878404765       ,
0.1454187093267178        ,
0.1443490463823681        ,
0.14329792347372491       ,
0.14226605568470985       ,
0.14124294366340068       ,
0.1402402349233823        ,
0.13924773268081464       ,
0.1382644727147503        ,
0.13730392287343504       ,
0.13635073880337434       ,
0.13541106105751263       ,
0.13448427624305034       ,
0.13357528141083352       ,
0.1326749770035377        ]
m2c_d = [ 3.1307923533618527		,
  3.0671033783399806        ,
  3.0253626078645843        ,
  2.9261433175459293        ,
  2.808786335485063         ,
  2.7060207128916978        ,
  2.6136905594104567        ,
  2.5070703273696004        ,
  2.3966663619745696        ,
  2.294895605753208         ,
  2.2008355100427024        ,
  2.1116938617618954        ,
  2.0285687849519176        ,
  1.9521772629238832        ,
  1.882692322306058         ,
  1.8185111524870419        ,
  1.7595046112858916        ,
  1.7052083779355194        ,
  1.65511561214338          ,
  1.6086366187282684        ,
  1.565523369691108         ,
  1.5252104289488135        ,
  1.4876200596890639        ,
  1.4523804902902953        ,
  1.4194012659983501        ,
  1.3884258348024388        ,
  1.3594222497210073        ,
  1.3320234276101073        ,
  1.3060978346480698        ,
  1.28156493853056          ,
  1.2583713923058122        ,
  1.2362084905506439        ,
  1.2151328713048777        ,
  1.195077784176769         ,
  1.1759063767857076        ,
  1.1576430260310255        ,
  1.1401427416962506        ,
  1.1233758920118502        ,
  1.1073009079159861        ,
  1.0920498909801046        ,
  1.077435595240903         ,
  1.0632421961308447        ,
  1.0496097393468993        ,
  1.036525211309532         ,
  1.0237794180125526        ,
  1.0115945761191993        ,
  0.9997959152377229        ,
  0.9884189074290439        ,
  0.9773999251822435        ,
  0.9667226551378046        ,
  0.9564198735379738        ,
  0.9463426319154541        ,
  0.9366353135702044        ,
  0.9273101532947399        ,
  0.9181900079992701        ,
  0.9093212736447172        ,
  0.9006905714966543        ,
  0.8923025989318322        ,
  0.8841717035547932        ,
  0.8762303125598759        ,
  0.8685310031159887        ,
  0.8609955776441948        ,
  0.8536252078477122        ,
  0.8464905099914075        ,
  0.8395240815255297        ,
  0.8327419614226523        ,
  0.8261071372752805        ,
  0.8196599550489668        ,
  0.8133156853212301        ,
  0.8071373418344652        ,
  0.8010914671261748        ,
  0.7951938184062912        ,
  0.7894037887497543        ,
  0.783748871018393         ,
  0.7782375926996558        ,
  0.7728103693374101        ,
  0.7675122446352851        ,
  0.7623113439700062        ,
  0.757224940975506         ,
  0.7522524683746815        ,
  0.747346727394987         ,
  0.7425338838364115        ,
  0.737838089789826         ,
  0.7332075191552377        ,
  0.7286718714746622        ,
  0.7242203141881516        ,
  0.7198437020727974        ,
  0.7155624635929312        ,
  0.7113370218535194        ,
  0.7071870680866174        ,
  0.7031250210276042        ,
  0.6991201208660859        ,
  0.6951832676764936        ,
  0.6913247899210372        ,
  0.687537384693811         ,
  0.6838262884975037        ,
  0.6801439469774636        ,
  0.6765231575616187        ,
  0.6729599632597617        ,
  0.6694528139473163        ,
  0.6660419418832547		,
0.6626463724168367        ,
0.6593158084134964        ,
0.6560411633153665        ,
0.6528097869620374        ,
0.6496244965823231        ,
0.6464844413962981        ,
0.6433884267288922        ,
0.640338287488833         ,
0.6373296763886434        ,
0.6343614792769184        ,
0.6314336964963105        ,
0.6285455565308122        ,
0.6257761942364173        ,
0.6229766777977263        ,
0.6202070308188304        ,
0.6174736212811873        ,
0.6148350075777329        ,
0.6121982270022736        ,
0.609572657475336         ,
0.6069617235569225        ,
0.6044543651891631        ,
0.6019222693888834        ,
0.5994409197801589        ,
0.5969772876613068        ,
0.5945418451165219        ,
0.5921319919277308        ,
0.5897933807592178        ,
0.5874327145837136        ,
0.5851258578905355        ,
0.5828167561617983        ,
0.580561786412266         ,
0.5783117082947028        ,
0.5761009509831847        ,
0.573943264206032         ,
0.571800164025528         ,
0.569655770202377         ,
0.5676029307963494        ,
0.565516284541739         ,
0.5634547273131902        ,
0.5614544897213692        ,
0.5594333472970906        ,
0.5574658648690318        ,
0.5555020326438609        ,
0.5535255793612937        ,
0.5516265431175614        ,
0.5497045189711778        ,
0.5478101208380542        ,
0.5459364446688307        ,
0.54410982076573          ,
0.5422820576836589        ]
m2c_l = [ 2.087152795378544			,
  2.0302297426270144        ,
  1.9980940147161528        ,
  1.9270124189863116        ,
  1.8459873289540396        ,
  1.776172240219769         ,
  1.7137786532701385        ,
  1.6423423588317028        ,
  1.569122340206536         ,
  1.5018914896284095        ,
  1.4399176427179647        ,
  1.3814197383027427        ,
  1.3271270770623775        ,
  1.277475389581768         ,
  1.2324575078445161        ,
  1.1909920965362213        ,
  1.1529305096788913        ,
  1.1179779998540358        ,
  1.0858043633169878        ,
  1.0559998573207474        ,
  1.0283874148989969        ,
  1.0025888838071164        ,
  0.9785385338383495        ,
  0.955979721752736         ,
  0.9348400821363356        ,
  0.9149595897106777        ,
  0.8963105996930234        ,
  0.8786723357785623        ,
  0.861961353681237         ,
  0.8461343041295675        ,
  0.8311631180339324        ,
  0.8168520847685109        ,
  0.8032351715006881        ,
  0.7902721098383325        ,
  0.7778755567333148        ,
  0.7660616894509001        ,
  0.7547375363710144        ,
  0.7438860963859636        ,
  0.7334790774318736        ,
  0.7236017695708391        ,
  0.7141314095508808        ,
  0.7049324318085137        ,
  0.6960916986103767        ,
  0.6876040417125733        ,
  0.6793310847747366        ,
  0.671419989198295         ,
  0.6637497267897012        ,
  0.6563492025547852        ,
  0.6491759576742057        ,
  0.6422204815019145        ,
  0.6355048799848763        ,
  0.6289299859259755        ,
  0.6225909508747711        ,
  0.6164962580849875        ,
  0.6105318761396336        ,
  0.604725920262737         ,
  0.5990700029484929        ,
  0.5935661036444462        ,
  0.5882249185347981        ,
  0.5830013864176616        ,
  0.5779305908033684        ,
  0.5729632276662827        ,
  0.5680996682842528        ,
  0.5633885579343814        ,
  0.5587860810715962        ,
  0.5543052727947578        ,
  0.5499213932249671        ,
  0.5456598389596331        ,
  0.5414686958954127        ,
  0.5373874110577682        ,
  0.5333925412239678        ,
  0.5294965070725567        ,
  0.5256715080142904        ,
  0.5219355366165096        ,
  0.5182940432923753        ,
  0.5147078937678328        ,
  0.5112068538894636        ,
  0.5077697694719032        ,
  0.5044069393925033        ,
  0.5011192317200877        ,
  0.49787617776550147       ,
  0.4946936760121116        ,
  0.4915881805171883        ,
  0.4885264510283728        ,
  0.48552712438191165       ,
  0.4825841707392881        ,
  0.47969094777168053       ,
  0.47686035384713904       ,
  0.4740678154317915        ,
  0.4713251247800437        ,
  0.4686398498272534        ,
  0.46599192275532725       ,
  0.4633889057789547        ,
  0.4608368229311539        ,
  0.458330291045598         ,
  0.45587327420661705       ,
  0.453435424064029         ,
  0.45103645925108843       ,
  0.44867426692326695       ,
  0.4463488229798603        ,
  0.44408605214733543       ,
  0.4418326711275079        ,
0.4396220165598452        ,
0.4374484132573158        ,
0.4353032971838381        ,
0.433188715719171         ,
0.43110433425107353       ,
0.4290494745843733        ,
0.42702520270492983       ,
0.42502881987318697       ,
0.4230596484911961        ,
0.42111744486756364       ,
0.4192016554899085        ,
0.4173644117966117        ,
0.4155084434862746        ,
0.4136718865982639        ,
0.4118595500968917        ,
0.41010971063510965       ,
0.4083620767218942        ,
0.40662104737073024       ,
0.40489010502134226       ,
0.40322737981538553       ,
0.4015493402200602        ,
0.39990387856342924       ,
0.3982702587023479        ,
0.39665533158169025       ,
0.3950572505401686        ,
0.3935059137311044        ,
0.3919400717764125        ,
0.3904092459159676        ,
0.38887810772593356       ,
0.38738070435078964       ,
0.3858875381140019        ,
0.38441916359398          ,
0.382985862958353         ,
0.3815625994372247        ,
0.3801380537232385        ,
0.37877338279801726       ,
0.3773866657889298        ,
0.3760163548545153        ,
0.37468655567805265       ,
0.3733426203971004        ,
0.3720336809414107        ,
0.37072770074621164       ,
0.36941316569233923       ,
0.3681497000098208        ,
0.36687128683061315       ,
0.3656108176498962        ,
0.3643641593610302        ,
0.36314827245466164       ,
0.3619319969074749        ]
m3c_d = [ 1.572319873263754			,
  1.5343437136452887        ,
  1.535365210114224         ,
  1.5371541370949915        ,
  1.5399386753452013        ,
  1.542535850958977         ,
  1.544569096841988         ,
  1.5462805902646286        ,
  1.548151152551296         ,
  1.5498433814663992        ,
  1.55117016229389          ,
  1.5523793338995995        ,
  1.5536197001248262        ,
  1.554359720117682         ,
  1.5554103972990772        ,
  1.555963600387445         ,
  1.5566752764851874        ,
  1.5574605893606897        ,
  1.5581259997672432        ,
  1.5586061257427963        ,
  1.5591303622888966        ,
  1.5594144717492362        ,
  1.5597132555036866        ,
  1.5599491172733546        ,
  1.560236133065416         ,
  1.5605254550956666        ,
  1.5609638782659145        ,
  1.561312192767859         ,
  1.5615657562477703        ,
  1.561822900729027         ,
  1.5621734761061004        ,
  1.5623012351020853        ,
  1.5624411429812135        ,
  1.5626057593788647        ,
  1.5627175726292128        ,
  1.5629094630179625        ,
  1.5630446002817584        ,
  1.5631625504243423        ,
  1.5632702582199496        ,
  1.563652344504694         ,
  1.5640888462119167        ,
  1.5642398946561462        ,
  1.5644455706199987        ,
  1.5647363177095472        ,
  1.5648006313209704        ,
  1.5650643184729938        ,
  1.5652569217197088        ,
  1.5654817392286193        ,
  1.5656694683412373        ,
  1.565822531150883         ,
  1.5660471856462304        ,
  1.5660453925553606        ,
  1.5662090611424206        ,
  1.5665492593223105        ,
  1.5667550823412664        ,
  1.5669103804089695        ,
  1.5670354358830179        ,
  1.5671626521716928        ,
  1.5673449573514384        ,
  1.5674351610204778        ,
  1.5676104475411103        ,
  1.5676800587123603        ,
  1.5676856947299618        ,
  1.567813724827083         ,
  1.5679034025055931        ,
  1.5680464836573622        ,
  1.568137890744315         ,
  1.5683063076757082        ,
  1.5683609478745362        ,
  1.5684678595696255        ,
  1.5685487749637688        ,
  1.5686607049896857        ,
  1.5687236561750695        ,
  1.5688079284687144        ,
  1.568945495635171         ,
  1.5689991264070402        ,
  1.569097029130719         ,
  1.5691680834165727        ,
  1.569258440040737         ,
  1.5693801509866614        ,
  1.5694244419173842        ,
  1.5694535566087502        ,
  1.5695478353759658        ,
  1.5695800570011367        ,
  1.5696275914343074        ,
  1.5696849359334053        ,
  1.5697162099022843        ,
  1.5697970627769389        ,
  1.56982580570039          ,
  1.5698503604225524        ,
  1.569921701135739         ,
  1.5699583143134113        ,
  1.5699948796776013        ,
  1.5700596590512694        ,
  1.5701512959672943        ,
  1.5702777778099375        ,
  1.5703105662135017        ,
  1.570348285543693         ,
  1.5703805490367164        ,
  1.5704107488962156        ,
  1.5705472692302516        ,
1.5705865797504526    ,
1.5706479566644183    ,
1.5707404184742177    ,
1.5708154318862697    ,
1.570884323468232     ,
1.5709486721561257    ,
1.571008651424666     ,
1.5710689094828865    ,
1.5711235854482588    ,
1.5711704645325233    ,
1.571215640455934     ,
1.5712596682166184    ,
1.5715412291289002    ,
1.5716180054079611    ,
1.5716681831967139    ,
1.5717139370941169    ,
1.571936652649401     ,
1.5720680177036817    ,
1.5721167005491188    ,
1.572084988426028     ,
1.5722921923333197    ,
1.5723141700468586    ,
1.5723985729807577    ,
1.5724447751496298    ,
1.5724832034325678    ,
1.572489941183491     ,
1.5726459295888522    ,
1.5726212213491708    ,
1.5726923061070055    ,
1.572666334603453     ,
1.5727280504106682    ,
1.5727218946057773    ,
1.5727562100115697    ,
1.5728775947507576    ,
1.5729815504356988    ,
1.5729759619632913    ,
1.5732182020286747    ,
1.5732604063304985    ,
1.5732908939531003    ,
1.5734757538035944    ,
1.573499206332998     ,
1.5736323413952535    ,
1.5737093491120469    ,
1.5736580260041189    ,
1.5738133155214815    ,
1.5738041003003065    ,
1.5738284955866684    ,
1.5738581653061434    ,
1.5739840957648839    ,
1.5740401191550661    ]
m3c_l = [ 1.048181510981824		,
  1.0123020052221547    ,
  1.010599296084571     ,
  1.0097015380604233    ,
  1.0102728615133536    ,
  1.0111865945938092    ,
  1.0118607892679243    ,
  1.0125627184977215    ,
  1.013679791170581     ,
  1.0148194044133199    ,
  1.0158444931106505    ,
  1.0169393871061814    ,
  1.0181839418625371    ,
  1.0192266033414104    ,
  1.0204985100709607    ,
  1.021504110909701     ,
  1.022627916315629     ,
  1.0238140883751141    ,
  1.024936799756232     ,
  1.0259339136355887    ,
  1.0269488731390346    ,
  1.0277873340146524    ,
  1.0286062170276713    ,
  1.0293503102395736    ,
  1.0300848545214756    ,
  1.0307870780589854    ,
  1.0315412903721541    ,
  1.0322149864848638    ,
  1.032801565672936     ,
  1.033369924844828     ,
  1.033981153947486     ,
  1.0344364224377878    ,
  1.0348819538842744    ,
  1.0353296161601493    ,
  1.0357302693148984    ,
  1.036169982633728     ,
  1.0365606610215805    ,
  1.036931457305812     ,
  1.0372844822241885    ,
  1.0378046481814853    ,
  1.0383473334501938    ,
  1.0386992899857375    ,
  1.0390726712621805    ,
  1.0394930605824733    ,
  1.0397541284839784    ,
  1.0401400530186014    ,
  1.0404606132151613    ,
  1.040794493898757     ,
  1.0410931650628044    ,
  1.0413611409329966    ,
  1.0416679430117584    ,
  1.0418149721680843    ,
  1.0420593893294245    ,
  1.0424109639223016    ,
  1.0426676552548897    ,
  1.0428814702449016    ,
  1.043067276129351     ,
  1.0432432366816267    ,
  1.0434496952395902    ,
  1.0435879325441628    ,
  1.0437754501713026    ,
  1.0438916989375595    ,
  1.0439599073937205    ,
  1.0441062309237892    ,
  1.0442243013961823    ,
  1.0443790138654099    ,
  1.0445000371800777    ,
  1.044665074617523     ,
  1.044759944082584     ,
  1.0448889576943199    ,
  1.0449954096488194    ,
  1.0451245955688724    ,
  1.045219570317888     ,
  1.0453269839923423    ,
  1.0454687317652156    ,
  1.045553093138846     ,
  1.0456667217958882    ,
  1.0457621887980808    ,
  1.045866269256879     ,
  1.0459914723194075    ,
  1.0460676429397668    ,
  1.0461310228650276    ,
  1.0462363353561468    ,
  1.0463019684393482    ,
  1.046375177318443     ,
  1.0464558692027983    ,
  1.0465184645941628    ,
  1.046611170396654     ,
  1.0466711513605866    ,
  1.0467274153229889    ,
  1.0468115880027387    ,
  1.0468704249966982    ,
  1.0469296699663813    ,
  1.04700565347288      ,
  1.0470954346420496    ,
  1.0472072444768226    ,
  1.0472602523744237    ,
  1.0473122619364104    ,
  1.0473581281257962    ,
  1.0474043435414233    ,
  1.0475192352830787    ,
  1.0475680497293545        ,
1.0476313994559712        ,
1.047716126886946         ,
1.0477886745460256        ,
1.0478567713557587        ,
1.0479223588421915        ,
1.047985508066564         ,
1.0480488276818083        ,
1.0481088417564524        ,
1.0481640889679051        ,
1.0482175174820427        ,
1.0482694948107283        ,
1.0484773803877845        ,
1.0485525743026634        ,
1.0486079465242426        ,
1.0486604749132957        ,
1.0488285391308512        ,
1.0489389742313724        ,
1.0489909139157991        ,
1.048990520457389         ,
1.0491472450814359        ,
1.0491842099362467        ,
1.0492585983649205        ,
1.0493080592841155        ,
1.0493524099722091        ,
1.0493750945428026        ,
1.0494949635815929        ,
1.0494958518728905        ,
1.0495581953220101        ,
1.049560509725926         ,
1.0496133932084815        ,
1.049625097568845         ,
1.049659827717007         ,
1.0497526445199241        ,
1.0498355857846722        ,
1.0498447544812568        ,
1.0500153877672114        ,
1.050055625733123         ,
1.050087731530199         ,
1.050221946145656         ,
1.0502479793787296        ,
1.0503447418526175        ,
1.0504066379181465        ,
1.050382976603996         ,
1.0504955937180434        ,
1.050500441508962         ,
1.0505261859705788        ,
1.0505554723319301        ,
1.0506468568514666        ,
1.05069297247263          ]
Sc_d = [1.0015519421067491	,
 1.02340061871196      ,
 1.0235872681299045    ,
 1.0231664558401254    ,
 1.0222440769626826    ,
 1.0214398233100757    ,
 1.0209118737996632    ,
 1.0203091125707562    ,
 1.019481155837611     ,
 1.0187064349759245    ,
 1.0180295323055784    ,
 1.0173540792096312    ,
 1.0167060239733658    ,
 1.0161023247087453    ,
 1.0155555341375433    ,
 1.0150398583933247    ,
 1.0145690901489561    ,
 1.0141271408330974    ,
 1.0137279566532114    ,
 1.013338835722972     ,
 1.0129915449687685    ,
 1.0126628780749816    ,
 1.0123632531281777    ,
 1.0120681417523403    ,
 1.011808885183508     ,
 1.0115429009734587    ,
 1.0113080605718734    ,
 1.0110783581534823    ,
 1.0108651502300865    ,
 1.010659016943392     ,
 1.0104671299183563    ,
 1.0102824386465419    ,
 1.0101080628883135    ,
 1.009938517289488     ,
 1.0097822954819606    ,
 1.009633004558336     ,
 1.009491731113643     ,
 1.009350538155408     ,
 1.0092157603814758    ,
 1.0090877881917093    ,
 1.0089643724163726    ,
 1.0088464892925444    ,
 1.0087305984322554    ,
 1.0086106884933013    ,
 1.0085178697861672    ,
 1.0084015449929356    ,
 1.0083219237264411    ,
 1.0082294656669346    ,
 1.008135275585263     ,
 1.008041990301939     ,
 1.0079538195132687    ,
 1.0078712672384929    ,
 1.0077891945341853    ,
 1.007724379676422     ,
 1.0076341790731358    ,
 1.0075571302877102    ,
 1.007484690140219     ,
 1.0074155873698685    ,
 1.0073477567977258    ,
 1.007280808025554     ,
 1.0072185385196748    ,
 1.0071504932157687    ,
 1.0070917716118373    ,
 1.0070320744785557    ,
 1.0069742137660844    ,
 1.0069093526456803    ,
 1.0068631344381114    ,
 1.0068151795382607    ,
 1.0067536219891644    ,
 1.0066969458090116    ,
 1.006652594849343     ,
 1.0066052533016256    ,
 1.0065527639134482    ,
 1.006504606178054     ,
 1.0064631567927038    ,
 1.0064148212436888    ,
 1.0063701766400839    ,
 1.006325229678296     ,
 1.0062854845013254    ,
 1.006247391521986     ,
 1.006200309571587     ,
 1.0061572134405614    ,
 1.0061228989565236    ,
 1.0060822699731844    ,
 1.0060459756994844    ,
 1.0060057889412366    ,
 1.0059688614014588    ,
 1.0059430397106361    ,
 1.0058996924423373    ,
 1.0058629875212286    ,
 1.0058299366787082    ,
 1.0057972624921376    ,
 1.005765236592548     ,
 1.005731598141957     ,
 1.0056967837310933    ,
 1.00567105483388      ,
 1.0056382191034046    ,
 1.005608351003244     ,
 1.0055774758286409    ,
 1.005547452599254     ,
 1.0055176092682567    ,
 1.0054912212522655    ,
 1.0054651361937563    ,
 1.0054395443863358    ,
 1.0054117951393853    ,
 1.0053833069532179    ,
 1.0053556488710385    ,
 1.0053288449531568    ,
 1.0053050454055596    ,
 1.0052807971064053    ,
 1.0052551691979754    ,
 1.0052300170866508    ,
 1.0052054334974345    ,
 1.0052026941176742    ,
 1.0051581229983324    ,
 1.0051346011628188    ,
 1.0051123914136888    ,
 1.0051058799446764    ,
 1.005067886541734     ,
 1.0050464297810506    ,
 1.0050243223119655    ,
 1.005019107226242     ,
 1.0049812691137172    ,
 1.0049618384920742    ,
 1.004939631860923     ,
 1.0049190183533432    ,
 1.0048967344291728    ,
 1.0048794422254959    ,
 1.004854233615891     ,
 1.0048447013204513    ,
 1.004799267882785     ,
 1.0048058448027468    ,
 1.0047721423950888    ,
 1.0047648397706381    ,
 1.0047571837607907    ,
 1.004729264082861     ,
 1.004707431227989     ,
 1.0046993701531126    ,
 1.0046765800750113    ,
 1.0046599445767426    ,
 1.004641853090306     ,
 1.0046235666166867    ,
 1.0046194574703071    ,
 1.0045913208943622    ,
 1.0045740319797059    ,
 1.0045620062702643    ,
 1.0045392900523125    ,
 1.0045280719695415    ,
 1.004509322093908     ,
 1.0045067602573035    ,
 1.0044802949889098    ]
Sc_l = [1.0010555258597558    ,
 1.0234512062912038    ,
 1.023645477323243     ,
 1.0232183265710428    ,
 1.0222810550488726    ,
 1.0214676787002914    ,
 1.0209342191118524    ,
 1.0203241041055777    ,
 1.019493656157013     ,
 1.0187166306902702    ,
 1.0180325745154897    ,
 1.0173559039090063    ,
 1.0167042827703798    ,
 1.0160975534302208    ,
 1.0155486714365773    ,
 1.015031507784255     ,
 1.014558960956577     ,
 1.0141179273628633    ,
 1.0137174393780362    ,
 1.0133273553206292    ,
 1.0129826791004313    ,
 1.0126512640842409    ,
 1.0123520000805935    ,
 1.0120582949398635    ,
 1.0117986380063355    ,
 1.0115346645047745    ,
 1.0112994932686978    ,
 1.0110708088609084    ,
 1.0108572892830656    ,
 1.0106520508948258    ,
 1.0104601806415618    ,
 1.0102759777780121    ,
 1.0101019079598235    ,
 1.0099330264228108    ,
 1.0097767891686298    ,
 1.009628030020879     ,
 1.0094860181795615    ,
 1.0093453526400067    ,
 1.009210726054844     ,
 1.0090834293459052    ,
 1.0089599392279052    ,
 1.0088418589946717    ,
 1.0087276896928252    ,
 1.0086092839869556    ,
 1.0085139998490156    ,
 1.0083996566632938    ,
 1.008318231061583     ,
 1.0082258983927403    ,
 1.0081321613996113    ,
 1.0080395107893603    ,
 1.0079506698675609    ,
 1.0078688159300284    ,
 1.0077871274183576    ,
 1.0077217198481092    ,
 1.0076320770379699    ,
 1.0075555749845475    ,
 1.0074832717219129    ,
 1.00741430503586      ,
 1.0073468257790479    ,
 1.0072798162366066    ,
 1.007218592435239     ,
 1.0071497664388398    ,
 1.0070909916488506    ,
 1.0070317431578808    ,
 1.006973547252777     ,
 1.0069094298230756    ,
 1.0068623223289035    ,
 1.0068141294481212    ,
 1.0067529671026998    ,
 1.006696981335217     ,
 1.0066519204325044    ,
 1.0066044363480504    ,
 1.006552168115263     ,
 1.0065042335543957    ,
 1.0064624674821987    ,
 1.0064142426970852    ,
 1.0063697243546317    ,
 1.006324694758339     ,
 1.006284860038423     ,
 1.006246532087967     ,
 1.0061997292484555    ,
 1.006156898224376     ,
 1.0061226818361677    ,
 1.0060816586670853    ,
 1.0060453935419553    ,
 1.0060053487332064    ,
 1.0059684133467275    ,
 1.0059420683854767    ,
 1.0058991239685349    ,
 1.0058625898013795    ,
 1.0058299464053557    ,
 1.0057968488285123    ,
 1.00576467896127      ,
 1.005731493417252     ,
 1.0056971444087062    ,
 1.0056708923359838    ,
 1.0056378359816436    ,
 1.0056080139233228    ,
 1.0055773312092318    ,
 1.0055473178681775    ,
 1.0055176291892738    ,
 1.0054910784590168    ,
 1.0054649778636475    ,
 1.0054391733184798    ,
 1.0054114748939806    ,
 1.0053831740352963    ,
 1.0053556231562097    ,
 1.0053288700689484    ,
 1.0053048390684918    ,
 1.005280465686417     ,
 1.0052549070305978    ,
 1.0052298216571116    ,
 1.0052052971628875    ,
 1.0052020815257638    ,
 1.00515807438554      ,
 1.0051345215181842    ,
 1.0051121647528811    ,
 1.0051053274230772    ,
 1.0050677129274463    ,
 1.005046164330336     ,
 1.0050238088830963    ,
 1.0050184543500655    ,
 1.0049811142373954    ,
 1.0049616397449863    ,
 1.0049395278243496    ,
 1.0049189023081482    ,
 1.0048966341443168    ,
 1.0048797360690696    ,
 1.0048542129441573    ,
 1.0048445802020118    ,
 1.0047993205000365    ,
 1.0048057330894686    ,
 1.0047721768105526    ,
 1.0047647534716257    ,
 1.0047568733405612    ,
 1.0047292716715017    ,
 1.004707444218184     ,
 1.0047006717752085    ,
 1.0046765249079201    ,
 1.0046598856689166    ,
 1.0046419892854335    ,
 1.004623536482115     ,
 1.0046191661390798    ,
 1.004591212403553     ,
 1.0045739357396806    ,
 1.0045626884087517    ,
 1.0045393347481222    ,
 1.0045281148095113    ,
 1.0045089762754162    ,
 1.0045065256519903    ,
 1.0044802567922329    ]

diff_m3=[]
zip_object = zip(m3c_d, m3c_l)
for m3c_d_i, m3c_l_i in zip_object:
    diff_m3.append(m3c_d_i-m3c_l_i)
sum_m3 = [sum(x) for x in zip(m3c_d, m3c_l)]

eec = [m/n for m, n in zip(diff_m3,sum_m3)]

m0c_d = [x / 1 for x in m0c_d]
m0c_l = [x / 1 for x in m0c_l]

m1c_d = [x / 1 for x in m1c_d]
m1c_l = [x / 1 for x in m1c_l]

m2c_d = [x / 1 for x in m2c_d]
m2c_l = [x / 1 for x in m2c_l]

m3c_d = [x / 1 for x in m3c_d]
m3c_l = [x / 1 for x in m3c_l]

pp.figure(9)
#Change the figure size
pp.figure(figsize=[16, 12])
pp.subplot(2,2,1)
pp.plot(r.t,r.y[0,:]/initial_m_d[0],'.r',r.t,m0c_d/initial_m_d[0],'-b')
pp.xlabel('time',{"fontsize":16})
pp.ylabel('m0(t)/m0(0)',{"fontsize":16})
pp.legend(('Maximum Entropy','Finite Elements (Comsol)'),loc='upper right',borderaxespad=0.1, fontsize=15)
pp.title('(a) Evolution of zeroth moment',fontsize=15)
pp.subplot(2,2,2)
pp.plot(r.t,r.y[1,:]/initial_m_d[1],'.r',r.t,m1c_d/initial_m_d[1],'-b')
pp.xlabel('time',{"fontsize":16})
pp.ylabel('m1(t)/m1(0)',{"fontsize":16})
pp.title('(b) Evolution of first moment',fontsize=15)
pp.legend(('Maximum Entropy','Finite Elements (Comsol)'),loc='upper right',borderaxespad=0.1, fontsize=15)
pp.subplot(2,2,3)
pp.plot(r.t,r.y[2,:]/initial_m_d[2],'.r',r.t,m2c_d/initial_m_d[2],'-b')
pp.xlabel('time',{"fontsize":16})
pp.ylabel('m2(t)/m2(0)',{"fontsize":16})
pp.title('(c) Evolution of second moment',fontsize=15)
pp.legend(('Maximum Entropy','Finite Elements (Comsol)'),loc='upper right',borderaxespad=0.1, fontsize=15)
pp.subplot(2,2,4)
pp.plot(r.t,r.y[3,:]/initial_m_d[3],'.r',r.t,m3c_d/initial_m_d[3],'-b')
pp.ylim([0.8, 1.2])
pp.xlabel('time',{"fontsize":16})
pp.ylabel('m3(t)/m3(0)',{"fontsize":16})
pp.title('(d) Evolution of third moment',fontsize=15)
pp.legend(('Maximum Entropy','Finite Elements (Comsol)'),loc='lower right',borderaxespad=0.1, fontsize=15)
pp.suptitle('Enantiomer D', x=0.5, y=0.95, fontsize=17, fontweight='700',)

pp.figure(10)
#Change the figure size
pp.figure(figsize=[16, 12])
pp.subplot(2,2,1)
pp.plot(r.t,r.y[4,:]/initial_m_l[0],'.r',r.t,m0c_l/initial_m_l[0],'-b')
pp.xlabel('time',{"fontsize":16})
pp.ylabel('m0(t)/m0(0)',{"fontsize":16})
pp.legend(('Maximum Entropy','Finite Elements (Comsol)'),loc='upper right',borderaxespad=0.1, fontsize=15)
pp.title('(a) Evolution of zeroth moment',fontsize=15)
pp.subplot(2,2,2)
pp.plot(r.t,r.y[5,:]/initial_m_l[1],'.r',r.t,m1c_l/initial_m_l[1],'-b')
pp.xlabel('time',{"fontsize":16})
pp.ylabel('m1(t)/m1(0)',{"fontsize":16})
pp.title('(b) Evolution of first moment',fontsize=15)
pp.legend(('Maximum Entropy','Finite Elements (Comsol)'),loc='upper right',borderaxespad=0.1, fontsize=15)
pp.subplot(2,2,3)
pp.plot(r.t,r.y[6,:]/initial_m_l[2],'.r',r.t,m2c_l/initial_m_l[2],'-b')
pp.xlabel('time',{"fontsize":16})
pp.ylabel('m2(t)/m2(0)',{"fontsize":16})
pp.title('(c) Evolution of second moment',fontsize=15)
pp.legend(('Maximum Entropy','Finite Elements (Comsol)'),loc='upper right',borderaxespad=0.1, fontsize=15)
pp.subplot(2,2,4)
pp.plot(r.t,r.y[7,:]/initial_m_l[3],'.r',r.t,m3c_l/initial_m_l[3],'-b')
pp.ylim([0.8, 1.2])
pp.xlabel('time',{"fontsize":16})
pp.ylabel('m3(t)/m3(0)',{"fontsize":16})
pp.title('(d) Evolution of third moment',fontsize=15)
pp.legend(('Maximum Entropy','Finite Elements (Comsol)'),loc='lower right',borderaxespad=0.1, fontsize=15)
pp.suptitle('Enantiomer L', x=0.5, y=0.95, fontsize=17, fontweight='700')

'''Σχετικό Σφάλμα χρονικής εξέλιξης ροπών'''
err0_d=[]
for i in range(len(r.y[0,:])): 
    err = np.abs(r.y[0,i]/initial_m_d[0]-m0c_d[i]/initial_m_d[0])/(m0c_d[i]/initial_m_d[0])*100
    err0_d.append(err)

err1_d=[]
for i in range(len(r.y[1,:])): 
    err = np.abs(r.y[1,i]/initial_m_d[1]-m1c_d[i]/initial_m_d[1])/(m1c_d[i]/initial_m_d[1])*100
    err1_d.append(err)
    
err2_d=[]
for i in range(len(r.y[2,:])): 
    err = np.abs(r.y[2,i]/initial_m_d[2]-m2c_d[i]/initial_m_d[2])/(m2c_d[i]/initial_m_d[2])*100
    err2_d.append(err)

err3_d=[]
for i in range(len(r.y[3,:])): 
    err = np.abs(r.y[3,i]/initial_m_d[3]-m3c_d[i]/initial_m_d[3])/(m3c_d[i]/initial_m_d[3])*100
    err3_d.append(err)
    
pp.figure(11)
#Change the figure size
pp.figure(figsize=[16, 12])
pp.subplot(2,2,1)
pp.plot(r.t,err0_d)
pp.xlabel('time',{"fontsize":16})
pp.ylabel('percentage error',{"fontsize":16})
pp.title('(a) Zeroth moment',fontsize=15)
pp.subplot(2,2,2)
pp.plot(r.t,err1_d)
pp.xlabel('time',{"fontsize":16})
pp.ylabel('percentage error',{"fontsize":16})
pp.title('(b) First moment',fontsize=15)
pp.subplot(2,2,3)
pp.plot(r.t,err2_d)
pp.xlabel('time',{"fontsize":16})
pp.ylabel('percentage error',{"fontsize":16})
pp.title('(c) Second moment',fontsize=15)
pp.subplot(2,2,4)
pp.plot(r.t,err3_d)
pp.xlabel('time',{"fontsize":16})
pp.ylabel('percentage error',{"fontsize":16})
pp.title('(d) Third moment',fontsize=15)
pp.suptitle('Enantiomer D', x=0.5, y=0.95, fontsize=17, fontweight='700',)


err0_l=[]
for i in range(len(r.y[4,:])): 
    err = np.abs(r.y[4,i]/initial_m_l[0]-m0c_l[i]/initial_m_l[0])/(m0c_l[i]/initial_m_l[0])*100
    err0_l.append(err)

err1_l=[]
for i in range(len(r.y[5,:])): 
    err = np.abs(r.y[5,i]/initial_m_l[1]-m1c_l[i]/initial_m_l[1])/(m1c_l[i]/initial_m_l[1])*100
    err1_l.append(err)
    
err2_l=[]
for i in range(len(r.y[6,:])): 
    err = np.abs(r.y[6,i]/initial_m_l[2]-m2c_l[i]/initial_m_l[2])/(m2c_l[i]/initial_m_l[2])*100
    err2_l.append(err)

err3_l=[]
for i in range(len(r.y[7,:])): 
    err = np.abs(r.y[7,i]/initial_m_l[3]-m3c_l[i]/initial_m_l[3])/(m3c_l[i]/initial_m_l[3])*100
    err3_l.append(err)
    
pp.figure(12)
#Change the figure size
pp.figure(figsize=[16, 12])
pp.subplot(2,2,1)
pp.plot(r.t,err0_l)
pp.xlabel('time',{"fontsize":16})
pp.ylabel('percentage error',{"fontsize":16})
pp.title('(a) Zeroth moment',fontsize=15)
pp.subplot(2,2,2)
pp.plot(r.t,err1_l)
pp.xlabel('time',{"fontsize":16})
pp.ylabel('percentage error',{"fontsize":16})
pp.title('(b) First moment',fontsize=15)
pp.subplot(2,2,3)
pp.plot(r.t,err2_l)
pp.xlabel('time',{"fontsize":16})
pp.ylabel('percentage error',{"fontsize":16})
pp.title('(c) Second moment',fontsize=15)
pp.subplot(2,2,4)
pp.plot(r.t,err3_l)
pp.xlabel('time',{"fontsize":16})
pp.ylabel('percentage error',{"fontsize":16})
pp.ylim([0, 2])
pp.title('(d) Third moment',fontsize=15)
pp.suptitle('Enantiomer L', x=0.5, y=0.95, fontsize=17, fontweight='700',)


'''Σύγκριση Υπερκορεσμών'''
pp.figure(13)
#Change the figure size
pp.figure(figsize=[16, 12])
pp.subplot(2,2,1)
pp.plot(r.t,r.y[8,:],'.r',r.t,Sc_d,'-b')
pp.xlabel('time',{"fontsize":16})
pp.ylabel('Sinf',{"fontsize":16})
pp.legend(('Maximum Entropy','Finite Elements (Comsol)'),loc='upper right',borderaxespad=0.1, fontsize=15)
pp.title('(a) Evolution of Supersaturation (D)',fontsize=15)
pp.subplot(2,2,2)
pp.plot(r.t,r.y[9,:],'.r',r.t,Sc_l,'-b')
pp.xlabel('time',{"fontsize":16})
pp.ylabel('Sinf',{"fontsize":16})
pp.title('(b) Evolution of Supersaturation (L)',fontsize=15)
pp.legend(('Maximum Entropy','Finite Elements (Comsol)'),loc='upper right',borderaxespad=0.1, fontsize=15)
pp.subplot(2,2,3)
pp.plot(r.t,np.abs(r.y[8,:]-Sc_d)/Sc_d*100)
pp.xlabel('time',{"fontsize":16})
pp.ylabel('Percentage error',{"fontsize":16})
pp.title('(c) Relative error of Supersaturation (D)',fontsize=15)
pp.subplot(2,2,4)
pp.plot(r.t,np.abs(r.y[9,:]-Sc_l)/Sc_l*100)
pp.xlabel('time',{"fontsize":16})
pp.ylabel('Percentage error',{"fontsize":16})
pp.title('(d) Relative error of Supersaturation (L)',fontsize=15)

pp.figure(14)
pp.plot(r.t,eec)
pp.ylim([0.199, 0.209])
pp.title('Evolution of enantiomeric excess')
pp.xlabel('time',{"fontsize":16})
pp.ylabel('ee',{"fontsize":16})


'''Κατανομές maxent και comsol για την τελευταία χρονική στιγμή'''
Lmin=0
Lmax=8
bnds=[Lmin,Lmax]

pp.figure(15)
mulast_d=[r.y[0,100],r.y[1,100],r.y[2,100],r.y[3,100]]
sollast_d, lambdaslast=maxent_reconstruct_c0_1(mu=mulast_d,bnds=bnds)

mulast_l=[r.y[4,100],r.y[5,100],r.y[6,100],r.y[7,100]]
sollast_l, lambdaslast=maxent_reconstruct_c0_2(mu=mulast_l,bnds=bnds)

'''reconstructed distribution from comsol moments at last time step'''
mu_comsol_d = [m0c_d[100],m1c_d[100],m2c_d[100],m3c_d[100]]
mu_comsol_l = [m0c_l[100],m1c_l[100],m2c_l[100],m3c_l[100]]

sol_comsol_d, lambdas_comsol_d = maxent_reconstruct_c0_1(mu=mu_comsol_d,bnds=bnds)
sol_comsol_l, lambdas_comsol_l = maxent_reconstruct_c0_2(mu=mu_comsol_l,bnds=bnds)

L=np.linspace(0,7)
pp.plot(L,sollast_d(L),'-b,', L,sollast_l(L),'-g',L,sol_comsol_d(L),'-r,', L,sol_comsol_l(L),'-y')
pp.title('t = 20')
pp.xlabel('L (μm)',{"fontsize":16})
pp.ylabel('n #/mLμL',{"fontsize":16})
pp.legend(('maxent f (D)','maxent f (L)', 'Comsol f (D)','Comsol f (L)'),loc=0)


