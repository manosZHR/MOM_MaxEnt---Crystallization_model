# -*- coding: utf-8 -*-
"""
Created on Sat May 28 16:05:39 2022

@author: Manos
"""

import time 
import numpy as np
from scipy.integrate import quad,solve_ivp
from numpy import sqrt, pi
import pylab as pp
from pymaxent import moments_c,maxent_reconstruct_c0_1,maxent_reconstruct_c1_1,maxent_reconstruct_c0_2,maxent_reconstruct_c1_2,temp1,temp2
from plyer import notification
from scipy.misc import derivative

start = time.time()

'''Constants'''
a0 = 3.5e-4
kv = pi/6 
dens = 1300
q0 = 400
q1 = 2500
kr0 = 1e11
Er = 75000

Sd0 = Sl0 = 1
lmeand0 = lmeanl0 = 0.5
σd0 = σl0 = 0.025

m3d0 = 0.062806
ratio = 1.5
m3l0 = m3d0/ratio

'''Αδιαστατοποίηση'''
Lr = 100e-6 
tr = 3600
Tr = 273
scale = 1e2

Eg = Ed = 12000
R = 8.314

kg = 1e-4
kd = 2e-4
kb = 0.001
Kbg = kb*tr

tol1 = 1e-3
tol2 = 1e-4

'''Αρχικοποίση των μεταβλητών'''
tspan=(0, 20)
step = 0.05
resolution = int(tspan[1]/step)
teval = np.linspace(tspan[0],tspan[1],resolution+1)


def f0_d(λ):
    return ( m3d0*lmeand0*(lmeand0**2+3*σd0**2)/(sqrt(2*pi*σd0)) * np.exp(-(λ-lmeand0)**2/(2*σd0**2)) )*scale 
def f0_l(λ):
    return ( m3l0*lmeanl0*(lmeanl0**2+3*σl0**2)/(sqrt(2*pi*σl0)) * np.exp(-(λ-lmeanl0)**2/(2*σl0**2)) )*scale 

initial_m_d = moments_c(f0_d, k=4, bnds=[0, np.inf])
initial_m_l = moments_c(f0_l, k=4, bnds=[0, np.inf])

initial_values = [*initial_m_d, *initial_m_l, Sd0, Sl0]

print("\033[1;36m"+'Initial moments (D)=',initial_m_d,'\nInitial moments (L)=',initial_m_d,'\033[39m')

ee0 = ( initial_m_d[3] - initial_m_l[3] ) / ( initial_m_d[3] + initial_m_l[3] )

'''Temperature Profile'''

Tmax = 308
Tmin = 298
t1 = 600
t2 = t1+600
t3 = t2+1800
t4 = t3+600

def theta0(tau):
    if 0<tau<=t1/tr: return (Tmax-Tmin)/Tr*(tr/t1)*tau + Tmin/Tr 
    if t1/tr<tau<=t2/tr: return Tmax/Tr
    if t2/tr<tau<=t3/tr: return -(Tmax-Tmin)/Tr*(tr*tau-t2)/(t3-t2) + Tmax/Tr
    else: return Tmin/Tr
    #if t3/tr<t<=t4/tr: return Tmin/Tr

def theta(tau): return theta0(tau)*Tr

# Function that will convert any given function 'f' defined in a given range '[a,b]' to a periodic function of period 'b-a' 
def periodicf(a,b,f,x):
    if x>=a and x<=b :
        return f(x)
    elif x>b:
        x_new=x-(b-a)
        return periodicf(a,b,f,x_new)
    elif x<(a):
        x_new=x+(b-a)
        return periodicf(a,b,f,x_new)
    
def T(tau): return periodicf(0,1,theta,tau)


def Kg(tau): return tr/Lr * kg*np.exp(-Eg/(R*T(tau)))
def Kd(tau): return tr/Lr * kd*np.exp(-Ed/(R*T(tau)))

def cinf_d(tau): return( q0*np.exp(-q1/T(tau)) )
def cinf_l(tau): return( q0*np.exp(-q1/T(tau)) )

def γ_d(tau): return( cinf_d(tau)/(Lr**3*kv*dens) )
def γ_l(tau): return( cinf_l(tau)/(Lr**3*kv*dens) )


'''Growth Term'''
def G_d(Sd,tau,L):
    jd =  Sd-1-a0/(L*Lr*T(tau))
    if jd>0: 
        result = Kg(tau) * jd 
        return result
    else: 
        result = Kd(tau) * jd 
        return result

def G_l(Sl,tau,L):
    jl =  Sl-1-a0/(L*Lr*T(tau))
    if jl>0: 
        result = Kg(tau) * jl 
        return result
    else: 
        result = Kd(tau) * jl 
        return result

'''Racemization rate'''
def Rd(Sl,Sd,tau):
    return( tr*kr0*np.exp(-Er/(R*T(tau)))*(Sl - Sd) )
def Rl(Sd,Sl,tau):
    return( tr*kr0*np.exp(-Er/(R*T(tau)))*(Sd - Sl) )

'''Daughter size distribution'''
q = 0
def g(L,λ): return( 3*L**2 * (2*q+1) * ( (2/(λ**3))**(2*q+1) ) * (L**3-(λ**3)/2)**(2*q) )

'''Breakage kernel'''
def a(l):
    return l**3


def moments(t,y):
    m0_d=y[0]
    m1_d=y[1]
    m2_d=y[2]
    m3_d=y[3]
    m0_l=y[4]
    m1_l=y[5]
    m2_l=y[6]
    m3_l=y[7]
    Sd=y[8]
    Sl=y[9]

    print("\033[1;31m" + '''current time is''',t,'''s/''',tspan[1],'''s''')
    
    eet1 = (m3_d-m3_l)/(m3_d+m3_l)
    print('\033[32m'+'''enantiomeric excess is''',eet1)
    print('\033[39m')
    
    Lmean_d = m1_d/m0_d
    σd = np.sqrt( np.abs(m2_d-2*Lmean_d*m1_d+Lmean_d**2*m0_d)/m0_d )
    Lmean_l = m1_l/m0_l
    σl = np.sqrt( np.abs(m2_l-2*Lmean_l*m1_l+Lmean_l**2*m0_l)/m0_l )
    
    Lmin_d = max(0.25,Lmean_d - 4*σd)
    Lmin_l = max(0.25,Lmean_l - 4*σl)
    Lmax_d = min(1.5,Lmean_d + 6*σd)
    Lmax_l = min(1.5,Lmean_l + 6*σl)

    bnds_d=[Lmin_d,Lmax_d] 
    sol_d, lambdas_d= maxent_reconstruct_c1_1(mu=y[0:4] ,bnds=bnds_d)
    bnds_l=[Lmin_l,Lmax_l]
    sol_l, lambdas_l= maxent_reconstruct_c1_2(mu=y[4:8] ,bnds=bnds_l)
    
    
    '''Growth functions'''
    def h_d(l,t,k):
        return l**k*sol_d(l)*G_d(Sd,t,l)
    def h_l(l,t,k):
        return l**k*sol_l(l)*G_l(Sl,t,l)
    
    '''Breakage functions'''
    def fd(L):
        def vd(l): return a(l)*g(L,l)*sol_d(l)
        result = quad(vd,L,bnds_d[1],epsabs=tol1)[0]
        return result
    
    def fl(L):
        def vl(l): return a(l)*g(L,l)*sol_l(l)
        result = quad(vl,L,bnds_l[1],epsabs=tol1)[0]
        return result

    def momd(L,Sd,t,k):
        return L**k * ( k*L**(-1)*G_d(Sd,t,L)*sol_d(L) + Kbg*(fd(L)-a(L)*sol_d(L)) )
    
    def moml(L,SL,t,k):
        return L**k * ( k*L**(-1)*G_l(Sl,t,L)*sol_l(L) + Kbg*(fl(L)-a(L)*sol_l(L)) )
    
    k=0
    dm0dt_d = quad(momd,bnds_d[0],bnds_d[1],epsabs=tol1,epsrel=tol2,args=(Sd,t,k))[0] - ( h_d(bnds_d[1],t,k) - h_d(bnds_d[0],t,k) )
    dm0dt_l = quad(moml,bnds_l[0],bnds_l[1],epsabs=tol1,epsrel=tol2,args=(Sl,t,k))[0] - ( h_l(bnds_l[1],t,k) - h_l(bnds_l[0],t,k) )
    k=1
    dm1dt_d = quad(momd,bnds_d[0],bnds_d[1],epsabs=tol1,epsrel=tol2,args=(Sd,t,k))[0] - ( h_d(bnds_d[1],t,k) - h_d(bnds_d[0],t,k) )
    dm1dt_l = quad(moml,bnds_l[0],bnds_l[1],epsabs=tol1,epsrel=tol2,args=(Sl,t,k))[0] - ( h_l(bnds_l[1],t,k) - h_l(bnds_l[0],t,k) )
    k=2
    dm2dt_d = quad(momd,bnds_d[0],bnds_d[1],epsabs=tol1,epsrel=tol2,args=(Sd,t,k))[0] - ( h_d(bnds_d[1],t,k) - h_d(bnds_d[0],t,k) )
    dm2dt_l = quad(moml,bnds_l[0],bnds_l[1],epsabs=tol1,epsrel=tol2,args=(Sl,t,k))[0] - ( h_l(bnds_l[1],t,k) - h_l(bnds_l[0],t,k) )
    k=3
    dm3dt_d = quad(momd,bnds_d[0],bnds_d[1],epsabs=tol1,epsrel=tol2,args=(Sd,t,k))[0] - ( h_d(bnds_d[1],t,k) - h_d(bnds_d[0],t,k) )
    dm3dt_l = quad(moml,bnds_l[0],bnds_l[1],epsabs=tol1,epsrel=tol2,args=(Sl,t,k))[0] - ( h_l(bnds_l[1],t,k) - h_l(bnds_l[0],t,k) )

    dSddt = -1/(scale*Lr**3*γ_d(t))*dm3dt_d + Rd(Sd,Sl,t) - Sd/cinf_d(t)*derivative(cinf_d,t,dx=1e-6)
    dSldt = -1/(scale*Lr**3*γ_l(t))*dm3dt_l + Rl(Sd,Sl,t) - Sl/cinf_l(t)*derivative(cinf_l,t,dx=1e-6)

    print('[Lmin_d,Lmax_d] = ',[Lmin_d,Lmax_d])
    print('[Lmin_l,Lmax_l] = ',[Lmin_l,Lmax_l])
    print('dmkdt = \n',[dm0dt_d,dm0dt_l], '\n', [dm1dt_d,dm1dt_l], '\n', [dm2dt_d,dm2dt_l], '\n', [dm3dt_d,dm3dt_l])
        
    return(dm0dt_d,dm1dt_d,dm2dt_d,dm3dt_d,dm0dt_l,dm1dt_l,dm2dt_l,dm3dt_l,dSddt,dSldt)


r=solve_ivp(moments ,tspan, initial_values, method='BDF',t_eval=teval, jac=None, rtol=1e-3)




'''Γράφημα εξέλιξης των ροπών'''
pp.figure(0)
pp.plot(r.t,r.y[0,:],'-b',r.t,r.y[4,:],'-g')
pp.xlabel('t(min)',{"fontsize":16})
pp.ylabel('m0(t)',{"fontsize":16})
pp.legend(('D','L'),loc=0)
pp.title('Evolution of zeroth moment')
pp.show()

pp.figure(1)
pp.plot(r.t,r.y[1,:],'-b',r.t,r.y[5,:],'-g')
pp.xlabel('t(min)',{"fontsize":16})
pp.ylabel('m1(t)',{"fontsize":16})
pp.legend(('D','L'),loc=0)
pp.title('Evolution of first moment')
pp.show()

pp.figure(2)
pp.plot(r.t,r.y[2,:],'-b',r.t,r.y[6,:],'-g')
pp.xlabel('t(min)',{"fontsize":16})
pp.ylabel('m2(t)',{"fontsize":16})
pp.legend(('D','L'),loc=0)
pp.title('Evolution of second moment')
pp.show()

pp.figure(3)
pp.plot(r.t,r.y[3,:],'-b',r.t,r.y[7,:],'-g')
pp.xlabel('t(min)',{"fontsize":16})
pp.ylabel('m3(t)',{"fontsize":16})
pp.legend(('D','L'),loc=0)
pp.title('Evolution of third moment')
pp.show()

'''Supersaturation'''
pp.figure(4)
pp.figure(figsize=[12, 10])
pp.plot(r.t,r.y[8,:],'-')
pp.plot(r.t,r.y[9,:],'-')
pp.xlabel('time',{"fontsize":16})
pp.ylabel('Sinf',{"fontsize":16})
pp.title('Evolution of Supersaturations')
pp.legend(('Sinf (D)','Sinf (L)'),loc='upper left',borderaxespad=1, fontsize=15)
pp.show()

'''Enantiomeric Excess'''
eet = (r.y[3,:] - r.y[7,:])/(r.y[3,:] + r.y[7,:])
pp.figure(5)
pp.figure(figsize=[12, 10])
pp.plot(r.t,eet)
pp.xlabel('time',{"fontsize":16})
pp.ylabel('enantiomeric excess',{"fontsize":16})
pp.title('Evolution of Enantiomeric Excess')
pp.show()

end=time.time()
print('''total time is ''', (end-start)/60, '''min''')

'''End of script notification'''

message= 'Script has finished running'
notification.notify(message= message,
                    app_icon = None,
                    timeout= 10,
                    toast=False)

'''Comsol comparison'''

m0c_d = [12.506450773241468		,
 12.75177968284131         ,
 12.90745495104277         ,
 12.961507879880392        ,
 12.937266510347847        ,
 12.895564373583362        ,
 12.816571238957694        ,
 12.668096817614618        ,
 12.471986107969016        ,
 12.252290099717694        ,
 12.029381855039835        ,
 11.818299335894977        ,
 11.627437071333686        ,
 11.45956517646697         ,
 11.316345560828694        ,
 11.196260160666666        ,
 11.088440235043764        ,
 10.986641566045279        ,
 10.86156440038124         ,
 10.712818209513882        ,
 10.541292635780167        ,
 10.279447754794795        ,
 9.903039997299087         ,
 9.399878458108262         ,
 8.769478100905319         ,
 8.220616475568335         ,
 7.759180779778676         ,
 7.375623118597876         ,
 7.115041752546            ,
 6.947875478158251         ,
 6.835226612674435         ,
 6.757744657866007         ,
 6.707756978977108         ,
 6.681825915889956         ,
 6.677129702388719         ,
 6.6909162822283434        ,
 6.720404642044933         ,
 6.7597431392992           ,
 6.78148255013254          ,
 6.7843075531164905        ,
 6.773333363373917         ,
 6.699742731789541         ,
 6.520991881531447         ,
 6.23956087845966          ,
 5.900924178298148         ,
 5.627346119756019         ,
 5.395705947182959         ,
 5.214383313976902         ,
 5.109302871941672         ,
 5.067676492578425         ,
 5.066402256651043         ,
 5.093281299239318         ,
 5.141742800552684         ,
 5.207179376302112         ,
 5.285866537961945         ,
 5.374939836809268         ,
 5.471967888348643         ,
 5.57375373847567          ,
 5.657348280748933         ,
 5.723472387956199         ,
 5.774781074140748         ,
 5.7700227381192075        ,
 5.666362507954971         ,
 5.467334554643824         ,
 5.213314049533709         ,
 5.020275306687111         ,
 4.858779324857242         ,
 4.733935253730018         ,
 4.676735210742179         ,
 4.6718501407974795        ,
 4.702153556316411         ,
 4.757066818207344         ,
 4.830150167166595         ,
 4.917535769035956         ,
 5.016308728422718         ,
 5.124127641815323         ,
 5.2391719569391375        ,
 5.357451206539287         ,
 5.458290370000214         ,
 5.543491580267904         ,
 5.61449019649408          ,
 5.628910452366991         ,
 5.545765607426951         ,
 5.369364091396679         ,
 5.13923079613182          ,
 4.9670831847042995        ,
 4.822419585358447         ,
 4.708418857894942         ,
 4.661726631574246         ,
 4.666657183307386         ,
 4.705298198234925         ,
 4.76840806619957          ,
 4.849512789919968         ,
 4.944408787579005         ,
 5.050250959891327         ,
 5.164855469644579         ,
 5.286478211200401         ,
 5.411438426468917         ,
 5.519532208403738         ,
 5.610511653213486         ,
 5.6871371122360825        ,
 5.705489173023876         ,
 5.626237075243646         ,
 5.453241519026934         ,
 5.224031791843365         ,
 5.053730680746017         ,
 4.910834857866927         ,
 4.795098696703369         ,
 4.744455769698404         ,
 4.7483318695987045        ,
 4.78751479210376          ,
 4.851634120331817         ,
 4.934043311353735         ,
 5.030661441119351         ,
 5.138572316423752         ,
 5.255427711806915         ,
 5.379394370130859         ,
 5.508135393938395         ,
 5.620863782154887         ,
 5.715496190951107         ,
 5.795303694093416         ,
 5.812562524891367         ,
 5.733257138950602         ,
 5.559603043311847         ,
 5.316897939498912         ,
 5.134689525250112         ,
 4.984281490831942         ,
 4.863169146348683         ,
 4.812951212144455         ,
 4.816774011945097         ,
 4.855711319110217         ,
 4.92103414969771          ,
 5.005417522404576         ,
 5.104099249947866         ,
 5.214064295914741         ,
 5.333044700722905         ,
 5.459206823517305         ,
 5.589367904516572         ,
 5.701242088616957         ,
 5.795828191882744         ,
 5.87586937791667          ,
 5.899430804803263         ,
 5.822350887921526         ,
 5.648143380842553         ,
 5.412989051882389         ,
 5.237166466570887         ,
 5.091553507730697         ,
 4.972496430550458         ,
 4.922690111898464         ,
 4.929498824863598         ,
 4.971805172310112         ,
 5.040113328413591         ,
 5.1275993550236           ,
 5.229656919882393         ,
 5.343130482930347         ,
 5.465603520601863         ,
 5.595200290597203         ,
 5.7290999550867685        ,
 5.847027783246858         ,
 5.9462073628649           ,
 6.0293593641007615        ,
 6.0458302481893895        ,
 5.962235425580543         ,
 5.7811146314544315        ,
 5.533747089615293         ,
 5.351393727561456         ,
 5.1998149951293575        ,
 5.080433833084615         ,
 5.03412319938929          ,
 5.043357440853166         ,
 5.088868099093918         ,
 5.160424583777904         ,
 5.251195484476876         ,
 5.356702255084341         ,
 5.473707689966214         ,
 5.59973928405529          ,
 5.732864947750214         ,
 5.8682066111484765        ,
 5.984439155323793         ,
 6.082594532616337         ,
 6.165146380888017         ,
 6.183506138079084         ,
 6.0985265601959675        ,
 5.912577941457495         ,
 5.667209815262099         ,
 5.4833438471575775        ,
 5.33164041121622          ,
 5.2100771609155           ,
 5.164077643251867         ,
 5.175733380446767         ,
 5.224227541849178         ,
 5.299346203514281         ,
 5.394047615897088         ,
 5.5036395994625815        ,
 5.624843556175464         ,
 5.755159111028631         ,
 5.892617396826352         ,
 6.033712654854154         ,
 6.157006234174852         ,
 6.260902045840224         ,
 6.348343992691782         ,
 6.375195313554781         ,
 6.295953164852166         ,
 6.113480383618033         ,
 5.861023564729313         ,
 5.670647555221738         ,
 5.514027913401876         ,
 5.389492422186103         ,
 5.340572167661688         ,
 5.350971655586718         ,
 5.399969158134886         ,
 5.476645310575941         ,
 5.573758332811505         ,
 5.686461005490438         ,
 5.811227153674009         ,
 5.945341977635419         ,
 6.086690565997607         ,
 6.231933893744843         ,
 6.3580189882811515        ,
 6.464124344583314         ,
 6.554071640400347         ,
 6.583974217869872         ,
 6.5036268195646665        ,
 6.316259580010014         ,
 6.058284508775389         ,
 5.862078262343501         ,
 5.702065971909874         ,
 5.570730950390944         ,
 5.513393555764292         ,
 5.520656666694026         ,
 5.568731243032057         ,
 5.646095597447977         ,
 5.745208677824898         ,
 5.86075226876903          ,
 5.988941379057232         ,
 6.1269254979997445        ,
 6.272497647129967         ,
 6.422759643966924         ,
 6.5538106301480195        ,
 6.663870041675171         ,
 6.756909057102514         ,
 6.776169565138737         ,
 6.6841708079397195        ,
 6.481480230595688         ,
 6.204372435507988         ,
 5.993822766397447         ,
 5.822271894523753         ,
 5.685224456391495         ,
 5.634372426221458         ,
 5.648053778290783         ,
 5.7018873811152995        ,
 5.785407955600312         ,
 5.891262903401928         ,
 6.013984136620712         ,
 6.149587012203135         ,
 6.2950970934341886        ,
 6.448256040243545         ,
 6.604993985526775         ,
 6.741288363809096         ,
 6.856062439923417         ,
 6.952136467506302         ,
 6.978566383723977         ,
 6.8890644016758875        ,
 6.683240686847234         ,
 6.398784824035341         ,
 6.181688588223506         ,
 6.0041604726305895        ,
 5.86294061094168          ,
 5.803260190671757         ,
 5.812750490094838         ,
 5.866924602778741         ,
 5.952906996896786         ,
 6.06253871429157          ,
 6.1900819110872645        ,
 6.3314200809059455        ,
 6.4840628057934255        ,
 6.644689148961611         ,
 6.807830282541951         ,
 6.950425800550652         ,
 7.070716355618596         ,
 7.172378440217256         ,
 7.207780338286159         ,
 7.119119033968648         ,
 6.906264255487416         ,
 6.608633969185242         ,
 6.378511354526801         ,
 6.189879754342917         ,
 6.043042001546402         ,
 5.979705064532356         ,
 5.987875001167544         ,
 6.043740289317879         ,
 6.133416131640431         ,
 6.248089943921528         ,
 6.381638936202972         ,
 6.530083772644779         ,
 6.689901558028474         ,
 6.858573758637431         ,
 7.032956638000832         ,
 7.188676382041821         ,
 7.320064961325065         ,
 7.430777838476219         ,
 7.461070546259825         ,
 7.362926630172314         ,
 7.1314556206276976        ,
 6.807903017373046         ,
 6.554069526390391         ,
 6.3466623000827065        ,
 6.186563847115951         ,
 6.111675882558964         ,
 6.114392925867691         ,
 6.168788358139057         ,
 6.259577285539661         ,
 6.377371722757361         ,
 6.515941191897039         ,
 6.670677653902102         ,
 6.8379938443718205        ,
 7.016056702113762         ,
 7.19903514391706          ,
 7.361474833904235         ,
 7.4997609828690495        ,
 7.617728366332543         ,
 7.663090701465653         ,
 7.570249886353837         ,
 7.33125563528496          ,
 6.985456231986067         ,
 6.705755517956445         ,
 6.48179580469354          ,
 6.313443067231166         ,
 6.238680963349572         ,
 6.244358912902571         ,
 6.302158291411499         ,
 6.39683915303122          ,
 6.519350046171808         ,
 6.663651510326912         ,
 6.824459426273166         ,
 7.000070700682605         ,
 7.1859472428331275        ,
 7.3752638153563375        ,
 7.551615147667798         ,
 7.700374655673378         ,
 7.8266315372345705        ,
 7.8737543836489365        ,
 7.774852759976955         ,
 7.518188305884247         ,
 7.1451182294713           ,
 6.836962134768993         ,
 6.596380976634461         ]
m1c_d =  [6.252507151237532			,
 6.09981809190866          ,
 5.9260788267128035        ,
 5.6895574962784305        ,
 5.5737723916274735        ,
 5.543658447826395         ,
 5.4987715101562795        ,
 5.447079589584759         ,
 5.4661232646702205        ,
 5.474504793251717         ,
 5.476933912202292         ,
 5.477288557068281         ,
 5.477927771975037         ,
 5.479831439196851         ,
 5.4836275586270045        ,
 5.488481764563739         ,
 5.493003980509463         ,
 5.486613981193445         ,
 5.42310076488195          ,
 5.356412842567549         ,
 5.276575200801881         ,
 5.022860772243063         ,
 4.710474364187964         ,
 4.338257372089732         ,
 4.028679986723821         ,
 3.8732522239879494        ,
 3.7373616810797903        ,
 3.6380375768946127        ,
 3.6246206075244456        ,
 3.63113492925407          ,
 3.646851611543854         ,
 3.668941816886183         ,
 3.6964230107736515        ,
 3.728756498381881         ,
 3.76535296701766          ,
 3.805547666160017         ,
 3.848641283607394         ,
 3.88187403180283          ,
 3.8776496468768493        ,
 3.868013716978252         ,
 3.853391918448985         ,
 3.710424705568977         ,
 3.505299644257608         ,
 3.2513649657721726        ,
 3.068162285327269         ,
 2.983490386170499         ,
 2.912532965800461         ,
 2.865066001959738         ,
 2.8886163232060484        ,
 2.9283624291492214        ,
 2.976382680146381         ,
 3.0304168218828655        ,
 3.0890443050195597        ,
 3.151176149514079         ,
 3.2159331140447778        ,
 3.2826395789636655        ,
 3.3507631653453633        ,
 3.4105765040683065        ,
 3.4335024609699962        ,
 3.4517205783773908        ,
 3.4649451399826026        ,
 3.3653131717921787        ,
 3.202184498592482         ,
 2.9920601403962674        ,
 2.837055112583174         ,
 2.7773970986559715        ,
 2.7284407770706354        ,
 2.700014329090233         ,
 2.734409193639098         ,
 2.7856428565708016        ,
 2.8444321175560137        ,
 2.9085283857389674        ,
 2.9765625955355914        ,
 3.04760556874309          ,
 3.120920297534486         ,
 3.1959212668243544        ,
 3.272143023927893         ,
 3.338924828544403         ,
 3.37238144622618          ,
 3.3997396910460496        ,
 3.421482482168912         ,
 3.3307107809699597        ,
 3.178243700580576         ,
 2.978406179219879         ,
 2.834769360517158         ,
 2.7815417700628173        ,
 2.7377856189383127        ,
 2.7142208277410664        ,
 2.752909331970411         ,
 2.808007122429611         ,
 2.870496210764054         ,
 2.938276495183104         ,
 3.0099000038263273        ,
 3.0843862753247118        ,
 3.1610170710194008        ,
 3.239225336422344         ,
 3.3185493991555566        ,
 3.388865007744385         ,
 3.4253927895668017        ,
 3.4554517985805515        ,
 3.4794236097458175        ,
 3.3884115752601534        ,
 3.237260287324415         ,
 3.0381707716733066        ,
 2.8903450251728935        ,
 2.837746515262679         ,
 2.7945110821025088        ,
 2.7652098146262785        ,
 2.802973200355352         ,
 2.8591238954677984        ,
 2.9228407904891           ,
 2.991911340362216         ,
 3.064883604129433         ,
 3.1407821589258864        ,
 3.2188514215307253        ,
 3.2984850306851117        ,
 3.3792039922559303        ,
 3.4562326353314323        ,
 3.494422374769291         ,
 3.525841221633155         ,
 3.5490460224950815        ,
 3.4547931915454964        ,
 3.302553991034397         ,
 3.101405425147229         ,
 2.929184185663719         ,
 2.874125769545065         ,
 2.82875209426827          ,
 2.802235031571992         ,
 2.8411944931629285        ,
 2.8985167807893575        ,
 2.9636203352648716        ,
 3.0343050203000588        ,
 3.108926517682674         ,
 3.186405992643717         ,
 3.265988053794351         ,
 3.3470804376302397        ,
 3.429195256219953         ,
 3.503814819339107         ,
 3.5409115358126586        ,
 3.572258798046358         ,
 3.598153157245846         ,
 3.511596722979344         ,
 3.3584440431095155        ,
 3.1548196564329887        ,
 2.9981736899339237        ,
 2.9437677455707716        ,
 2.899729749891666         ,
 2.871081826901152         ,
 2.912212195476079         ,
 2.971801732229583         ,
 3.039031260171849         ,
 3.1117588093355915        ,
 3.188424547674131         ,
 3.2679409096431007        ,
 3.3495096111553733        ,
 3.432506354966647         ,
 3.516437587798801         ,
 3.5948617855586655        ,
 3.6360509387074145        ,
 3.668997977970582         ,
 3.6926998602618837        ,
 3.592059130713866         ,
 3.434646167066829         ,
 3.225526490904498         ,
 3.0588297922611742        ,
 3.002998557923697         ,
 2.957356798001052         ,
 2.936236674738884         ,
 2.980292889527707         ,
 3.042175604703453         ,
 3.111888996965403         ,
 3.1870406887934712        ,
 3.2660721138137414        ,
 3.347904813920858         ,
 3.431715984437848         ,
 3.5168643901450842        ,
 3.6028420737403177        ,
 3.6758228787109437        ,
 3.715047782859278         ,
 3.7476031007126314        ,
 3.7725196815605777        ,
 3.674517143334511         ,
 3.513963721640558         ,
 3.2996632299412076        ,
 3.1416443497111737        ,
 3.0843564618809753        ,
 3.0388894411803746        ,
 3.0140770888964803        ,
 3.06131631052834          ,
 3.125858939973114         ,
 3.1982325431174226        ,
 3.2761074738474165        ,
 3.3578704699722417        ,
 3.4423957274795822        ,
 3.5288405791824538        ,
 3.6165459625889618        ,
 3.7049855542704946        ,
 3.7851444342473948        ,
 3.8279033319046243        ,
 3.8623626294793425        ,
 3.890628723732914         ,
 3.800858460283429         ,
 3.6401154750430407        ,
 3.4236601028534523        ,
 3.2493813131494083        ,
 3.1889556061288467        ,
 3.141762540526426         ,
 3.118395362812816         ,
 3.164497503041387         ,
 3.2304741728064954        ,
 3.3048802709041536        ,
 3.385034501580518         ,
 3.4692397674011333        ,
 3.5563016810682395        ,
 3.6453057840605525        ,
 3.735539811957344         ,
 3.8264478864025437        ,
 3.9091307157217465        ,
 3.9514046304450527        ,
 3.986642383293754         ,
 4.016107696289901         ,
 3.926742496983721         ,
 3.7619932752855636        ,
 3.5393658855302803        ,
 3.361121376330751         ,
 3.2984404665634806        ,
 3.250112981724335         ,
 3.21998947040482          ,
 3.262290150220616         ,
 3.329479212066336         ,
 3.4058590672555495        ,
 3.4883668803118053        ,
 3.575188161362652         ,
 3.665011774065001         ,
 3.7568529673688276        ,
 3.8499469509734183        ,
 3.9436987898055715        ,
 4.031500020697677         ,
 4.075110676559217         ,
 4.111686916019822         ,
 4.137600903803336         ,
 4.027260924165128         ,
 3.8535430625353477        ,
 3.6186612282342625        ,
 3.428463386796697         ,
 3.3613888578586364        ,
 3.309914603506067         ,
 3.28469387460235          ,
 3.337882028169587         ,
 3.4101120655001904        ,
 3.491116618971502         ,
 3.5783490529293425        ,
 3.669986746134715         ,
 3.76464910199862          ,
 3.8612811838770535        ,
 3.9590657360756354        ,
 4.0573539531184615        ,
 4.145426572328271         ,
 4.191940816587834         ,
 4.229908844118892         ,
 4.260219247425252         ,
 4.157702031864014         ,
 3.9793045230525483        ,
 3.7355457191648793        ,
 3.5402061200176353        ,
 3.46988746537249          ,
 3.4168786901036095        ,
 3.383805181034477         ,
 3.433072527272349         ,
 3.5069906569973157        ,
 3.5912672912378003        ,
 3.6823472547682328        ,
 3.778228139459108         ,
 3.877449263210238         ,
 3.9788891129493953        ,
 4.081647209250169         ,
 4.18493533772331          ,
 4.2768882141460045        ,
 4.32552212393539          ,
 4.365370156952333         ,
 4.398563419381157         ,
 4.3012470662858755        ,
 4.115490897322794         ,
 3.859525493097275         ,
 3.651947376868134         ,
 3.576064813310826         ,
 3.519731553205674         ,
 3.486219770677288         ,
 3.534846405071365         ,
 3.611317516752961         ,
 3.699308388890435         ,
 3.7947514882266953        ,
 3.895460965091663         ,
 3.9998862619214455        ,
 4.10684487053254          ,
 4.215348100387302         ,
 4.324589682261281         ,
 4.429200806514862         ,
 4.485117423301168         ,
 4.529123529785897         ,
 4.5605503815162045        ,
 4.444258258442584         ,
 4.244343717665304         ,
 3.968306005929092         ,
 3.742120564697144         ,
 3.656767659938133         ,
 3.5946258455679967        ,
 3.5552522937613404        ,
 3.601032496166893         ,
 3.6791474493725915        ,
 3.770181745947122         ,
 3.8695958644060737        ,
 3.9750497062829564        ,
 4.084926022266795         ,
 4.197950291423473         ,
 4.313090599252447         ,
 4.429475016458629         ,
 4.5362401042374065        ,
 4.5968707498803045        ,
 4.643847404580006         ,
 4.68241648503903          ,
 4.5801137155427645        ,
 4.369828526096535         ,
 4.076281727127324         ,
 3.825746043990778         ,
 3.729381900411333         ,
 3.6621751618427187        ,
 3.623271688287804         ,
 3.6753996064207834        ,
 3.7565923643453627        ,
 3.8509697496096074        ,
 3.9541574911969413        ,
 4.063897876043854         ,
 4.178620221058547         ,
 4.297022112713136         ,
 4.41817040822801          ,
 4.541188526407655         ,
 4.655240268387378         ,
 4.7238854850248755        ,
 4.775533543024952         ,
 4.816853155545459         ,
 4.70468690887774          ,
 4.478568399615251         ,
 4.163575319838482         ,
 3.891970067674675         ,
 3.784953550457445         ,
 3.7121414170601006        ]
m2c_d = [3.1337237031885516		,
 2.9412032648893134        ,
 2.7571915457853664        ,
 2.5444986531855345        ,
 2.458019222247769         ,
 2.45177068678263          ,
 2.4429442809418354        ,
 2.441935568152191         ,
 2.507152825818397         ,
 2.566889263393649         ,
 2.62180323893448          ,
 2.672909892124476         ,
 2.7209702105908513        ,
 2.7664549069174273        ,
 2.8097069737517226        ,
 2.8507545959349305        ,
 2.889643563906652         ,
 2.9170975509175374        ,
 2.8947573450934105        ,
 2.8739477796452633        ,
 2.844272299334743         ,
 2.6638695020813428        ,
 2.4539466385491577        ,
 2.2180637349796313        ,
 2.063319042706723         ,
 2.0294380357452635        ,
 1.9980809698992974        ,
 1.986036946156224         ,
 2.0329433161564046        ,
 2.0835185306445245        ,
 2.1332518128683517        ,
 2.182068895570902         ,
 2.2301012915603247        ,
 2.2774556528549357        ,
 2.324169905888693         ,
 2.370236375102897         ,
 2.4156149594802754        ,
 2.448170573305617         ,
 2.444409251500321         ,
 2.4390109000972147        ,
 2.4313260961727785        ,
 2.298850201502632         ,
 2.127000543560213         ,
 1.9310090125628234        ,
 1.8230610820443403        ,
 1.8019665349264014        ,
 1.7842520952475829        ,
 1.7800127909917034        ,
 1.8329019810263207        ,
 1.889820807555564         ,
 1.9465783373771528        ,
 2.0030050212953396        ,
 2.0589432353185906        ,
 2.1142684123254476        ,
 2.1688875459524435        ,
 2.2227434495652063        ,
 2.275805653157748         ,
 2.3179327927866082        ,
 2.322775217426654         ,
 2.327006661377077         ,
 2.3295315373750287        ,
 2.2174946917991525        ,
 2.0617055211677635        ,
 1.8814136252029374        ,
 1.7770322196390298        ,
 1.7620428776148191        ,
 1.7501845458135483        ,
 1.7512348447610708        ,
 1.804816641549887         ,
 1.8650704847560116        ,
 1.9252813107680131        ,
 1.9851128144955899        ,
 2.0443944428032843        ,
 2.1030114207439           ,
 2.1608747377057353        ,
 2.217927327514838         ,
 2.274130263283913         ,
 2.318261193481242         ,
 2.3284191221792288        ,
 2.3360633146748464        ,
 2.341459192238915         ,
 2.2314786019039476        ,
 2.0792733630753286        ,
 1.9018391043046254        ,
 1.802583459498274         ,
 1.7893375834948342        ,
 1.779004699262501         ,
 1.782240989986728         ,
 1.8378354761995916        ,
 1.8998615029317338        ,
 1.961819729596856         ,
 2.0233754826630066        ,
 2.0843249282427623        ,
 2.1445411820421265        ,
 2.203936479729909         ,
 2.26245160809079          ,
 2.3200464514923658        ,
 2.365999115990915         ,
 2.3771448727009292        ,
 2.3857800743092374        ,
 2.39171966566428          ,
 2.279546638261944         ,
 2.1270027279806913        ,
 1.9486645172149173        ,
 1.8440741460028944        ,
 1.831044127074198         ,
 1.820943606098025         ,
 1.818393970962541         ,
 1.8738149651363223        ,
 1.9372055471797835        ,
 2.000401944649089         ,
 2.0631347691100146        ,
 2.1252101650278643        ,
 2.186500194194851         ,
 2.2469085978222036        ,
 2.306369029149653         ,
 2.364842193392294         ,
 2.4174543891855707        ,
 2.4291338094675936        ,
 2.438187493793096         ,
 2.4421903433659686        ,
 2.3262448257217474        ,
 2.172239882885952         ,
 1.9915900216864102        ,
 1.8633894449876722        ,
 1.8503958969452692        ,
 1.8399138195654636        ,
 1.8415691047156713        ,
 1.898358244852142         ,
 1.9632076464127304        ,
 2.027968271310835         ,
 2.0922136123634183        ,
 2.1557029578678173        ,
 2.218297286370835         ,
 2.279904666638307         ,
 2.3404646030450156        ,
 2.399937326135669         ,
 2.4493374787989723        ,
 2.459965711337833         ,
 2.4689929550497824        ,
 2.476097230223491         ,
 2.367563775075512         ,
 2.211806621256484         ,
 2.028259577139742         ,
 1.9153032646715784        ,
 1.9015910041823376        ,
 1.8914750840627346        ,
 1.8904305219288018        ,
 1.9494011216807825        ,
 2.016085559170673         ,
 2.082469942218209         ,
 2.148252028709898         ,
 2.2132044776994726        ,
 2.277178875145848         ,
 2.3400740835582163        ,
 2.4018236576518555        ,
 2.462391137322648         ,
 2.5151019417926883        ,
 2.528722169310074         ,
 2.538208302190164         ,
 2.541835318504782         ,
 2.4185112088675793        ,
 2.2597050261607907        ,
 2.071981653132597         ,
 1.950846734830159         ,
 1.9372635382720929        ,
 1.9269080208013782        ,
 1.9341587664687798        ,
 1.9957448781575027        ,
 2.0644262478816193        ,
 2.1328885625405687        ,
 2.20064477174083          ,
 2.2674574385346844        ,
 2.3331765085341787        ,
 2.397694002959806         ,
 2.460940525281841         ,
 2.5228793733228887        ,
 2.5688153421971736        ,
 2.580582282981523         ,
 2.589950064512983         ,
 2.5952187492594434        ,
 2.4747793666208695        ,
 2.312825918227495         ,
 2.1204232520072814        ,
 2.008625387269159         ,
 1.993784191808546         ,
 1.9836036856393273        ,
 1.98731176279389          ,
 2.052308639500424         ,
 2.123451060546893         ,
 2.1941915621520476        ,
 2.26414048499755          ,
 2.333050526580077         ,
 2.4007564065887768        ,
 2.467141437594254         ,
 2.532128449044229         ,
 2.5956754606515915        ,
 2.648310414083729         ,
 2.6621640369578556        ,
 2.6720660611441382        ,
 2.6797615790970983        ,
 2.5663750982508073        ,
 2.4021361439825406        ,
 2.205967809156395         ,
 2.077675685264869         ,
 2.0610700165996474        ,
 2.0504157229560938        ,
 2.0565816891137003        ,
 2.1211180278064           ,
 2.1941772782679347        ,
 2.267112151572871         ,
 2.3392504669311314        ,
 2.4102978674659914        ,
 2.4800646031793407        ,
 2.5484113210635226        ,
 2.615245221825003         ,
 2.6805165108621947        ,
 2.7348797288265665        ,
 2.747290788371782         ,
 2.7573698961068698        ,
 2.7657254085740064        ,
 2.6521020130748165        ,
 2.4835985956164497        ,
 2.2816454832030884        ,
 2.150445850177887         ,
 2.132862754626934         ,
 2.122009806566118         ,
 2.122567943739354         ,
 2.18475201976148          ,
 2.259988605612698         ,
 2.3354244119840257        ,
 2.4100759171030277        ,
 2.4836103121278836        ,
 2.5558012629998528        ,
 2.626483297143347         ,
 2.6955408322236765        ,
 2.7629063974674173        ,
 2.821766704988915         ,
 2.834248363031583         ,
 2.8446476498021647        ,
 2.847993801202217         ,
 2.7127245873664894        ,
 2.537527232577601         ,
 2.3262085397168195        ,
 2.1868985743398235        ,
 2.168076803279977         ,
 2.15653509782929          ,
 2.163678575127586         ,
 2.2365462298029835        ,
 2.3161139693049364        ,
 2.395443109250782         ,
 2.4739507719192044        ,
 2.5512852237770445        ,
 2.6271825617219218        ,
 2.7014396347270706        ,
 2.7739086444518524        ,
 2.8444890592964716        ,
 2.9018681911568254        ,
 2.9163292949099535        ,
 2.9272368162103057        ,
 2.934880019761567         ,
 2.806754054358707         ,
 2.6250192085495874        ,
 2.4041568668717472        ,
 2.2608411920403544        ,
 2.2400807835211913        ,
 2.2280661177882606        ,
 2.2278983871055074        ,
 2.2984967275054466        ,
 2.3808256199004214        ,
 2.463812811835343         ,
 2.546150260927453         ,
 2.6274042882548696        ,
 2.707265769147263         ,
 2.7854839619402187        ,
 2.8618592638593734        ,
 2.936234633934564         ,
 2.9960746126277455        ,
 3.0111021104165596        ,
 3.0225013801461103        ,
 3.0319033028358082        ,
 2.9073890575449           ,
 2.7167333929317112        ,
 2.4836790268437094        ,
 2.3302929189816153        ,
 2.3067023482195523        ,
 2.2935141248849713        ,
 2.2942918102673477        ,
 2.3651469980661184        ,
 2.4506370200454035        ,
 2.53744505703189          ,
 2.623889514087959         ,
 2.7094432979439405        ,
 2.7937517093526005        ,
 2.8765192704572846        ,
 2.957493961765909         ,
 3.0364603285458824        ,
 3.108058305754898         ,
 3.12777160944016          ,
 3.1407126508250673        ,
 3.1454367441688436        ,
 2.999981790778587         ,
 2.795817083093861         ,
 2.545427784731715         ,
 2.37856277030378          ,
 2.350500252537622         ,
 2.3353329818285595        ,
 2.3331301711516095        ,
 2.403486160207479         ,
 2.4921214405569665        ,
 2.5828308218753993        ,
 2.6736314750276833        ,
 2.7639213305336567        ,
 2.8533191963034095        ,
 2.9414992108264735        ,
 3.0281658945059955        ,
 3.1130472918828977        ,
 3.1847165822006627        ,
 3.207994073089464         ,
 3.2224467197332087        ,
 3.233549457744781         ,
 3.100216054814231         ,
 2.882082381673884         ,
 2.613588419096283         ,
 2.425581076124502         ,
 2.3913776466273946        ,
 2.3741307298809464        ,
 2.3744016770500433        ,
 2.451588753565727         ,
 2.543111161005139         ,
 2.636906766160675         ,
 2.7311244893806297        ,
 2.825198734610086         ,
 2.9187716467518836        ,
 3.011531625318373         ,
 3.1032010666479684        ,
 3.1935169937406833        ,
 3.27127424023036          ,
 3.300687030357435         ,
 3.317705211726947         ,
 3.3295953946094095        ,
 3.1841691202671503        ,
 2.9493059646714523        ,
 2.6615913526240305        ,
 2.4578152890060627        ,
 2.4184104691316595        ,
 2.398959452304277         ]
m3c_d = [1.5745074726435089	,
 1.4261075910477854    ,
 1.2941494260044228    ,
 1.1522934904440278    ,
 1.10155364463336      ,
 1.1057395718662126    ,
 1.1111273448304853    ,
 1.124896397093049     ,
 1.1838433039389014    ,
 1.2407428296090275    ,
 1.2952431368485535    ,
 1.3474666369933512    ,
 1.3975872563965808    ,
 1.4457667180814717    ,
 1.4921636955017703    ,
 1.536913326026128     ,
 1.5801408255321614    ,
 1.6148254039638972    ,
 1.6128651074878821    ,
 1.6131596759175613    ,
 1.6074520435296225    ,
 1.4891554020019069    ,
 1.3558598213376465    ,
 1.2112040497881453    ,
 1.132174868603173     ,
 1.1374699696834272    ,
 1.1413658040303736    ,
 1.1567845646603043    ,
 1.2137503620100736    ,
 1.2710242949455073    ,
 1.3258426645224022    ,
 1.378420813449713     ,
 1.4289448991776748    ,
 1.477566090234876     ,
 1.5244127423801588    ,
 1.5696020127134178    ,
 1.6132381179406776    ,
 1.6448692562466969    ,
 1.6451575140124388    ,
 1.6449903423812942    ,
 1.6435241393839242    ,
 1.5340775621904403    ,
 1.3982081595638798    ,
 1.2498063850674248    ,
 1.1820814621168176    ,
 1.1846417329338643    ,
 1.1870400416020095    ,
 1.1983298551514792    ,
 1.2557096123436307    ,
 1.3136766263036475    ,
 1.3692094858863015    ,
 1.4225476187030093    ,
 1.473819937723501     ,
 1.5231421050042762    ,
 1.5706251512615002    ,
 1.6163777191326236    ,
 1.660505294275782     ,
 1.693586816342382     ,
 1.692425223994085     ,
 1.6920821924195872    ,
 1.691270746329283     ,
 1.585541800070626     ,
 1.4480291351967414    ,
 1.2973688093057696    ,
 1.221930397818419     ,
 1.2237245323426649    ,
 1.2257806341163069    ,
 1.2370195795884815    ,
 1.2925044827850523    ,
 1.3511989635773807    ,
 1.4075324730859677    ,
 1.4616101305561144    ,
 1.51355877702615      ,
 1.563495093958074     ,
 1.6115290793789954    ,
 1.6577726498427943    ,
 1.7023320957278152    ,
 1.73459587269631      ,
 1.7351734879673908    ,
 1.734799136504933     ,
 1.7336305114448936    ,
 1.6252962694587665    ,
 1.4864748287239093    ,
 1.3339543211394298    ,
 1.2601579293650615    ,
 1.2618872704360498    ,
 1.2639358754823558    ,
 1.276013942904539     ,
 1.3326486319345001    ,
 1.392287340552523     ,
 1.449489787892392     ,
 1.5043627271742963    ,
 1.5570281453533548    ,
 1.6076052924295587    ,
 1.6562091891006139    ,
 1.7029537568521067    ,
 1.7479497868466471    ,
 1.7810044996696275    ,
 1.7813643973369884    ,
 1.7809458912388914    ,
 1.7793677496464146    ,
 1.6677626767005462    ,
 1.5275187754700128    ,
 1.373102310826928     ,
 1.2938997858652508    ,
 1.2956795369761867    ,
 1.2978268899755956    ,
 1.3046420013802786    ,
 1.36132178175028      ,
 1.422296118877429     ,
 1.4806272035716896    ,
 1.5365166186927706    ,
 1.5900994655322809    ,
 1.6414991293984948    ,
 1.6908345129200466    ,
 1.7382231516174453    ,
 1.7837830708612994    ,
 1.8229400886646352    ,
 1.8232773545291154    ,
 1.822800764010782     ,
 1.8189194171035559    ,
 1.7035275150226388    ,
 1.5617145255141724    ,
 1.4050229501431963    ,
 1.3048317940166956    ,
 1.30740389694249      ,
 1.3097832041647552    ,
 1.3208185322146535    ,
 1.3788504357395364    ,
 1.4412694688645677    ,
 1.5010874227043094    ,
 1.558345536370409     ,
 1.6131684966344946    ,
 1.6656837972109393    ,
 1.7160141358673513    ,
 1.7642830401159166    ,
 1.8106128233021057    ,
 1.8464706737714462    ,
 1.8458508101216637    ,
 1.8453737405407649    ,
 1.8444961802081656    ,
 1.7358280560303663    ,
 1.5919929549306497    ,
 1.4323731784849685    ,
 1.3457298174977692    ,
 1.3472687048376215    ,
 1.3496907397716789    ,
 1.358113971868026     ,
 1.4181379946013157    ,
 1.482138559231707     ,
 1.543306200248326     ,
 1.6018028116091922    ,
 1.6577575388004764    ,
 1.7112962355297727    ,
 1.7625437407204019    ,
 1.8116260251797172    ,
 1.8586722259906265    ,
 1.8973844984269472    ,
 1.89906837867125      ,
 1.8985329224804937    ,
 1.8939401769783688    ,
 1.7712909203102034    ,
 1.6251953681620714    ,
 1.4623373445396262    ,
 1.3689423337730613    ,
 1.3711117046889134    ,
 1.3737689049991417    ,
 1.389960572607294     ,
 1.4523325115150443    ,
 1.5180972128711394    ,
 1.5810738403795124    ,
 1.6412556571547905    ,
 1.6987584454127655    ,
 1.7537071478643347    ,
 1.8062260746178291    ,
 1.8564440369840949    ,
 1.9044950304621104    ,
 1.9363896824670697    ,
 1.9363989407976883    ,
 1.9358700871410837    ,
 1.9329589147339292    ,
 1.8131524740516023    ,
 1.6641356813719372    ,
 1.4971094115932788    ,
 1.4123683309294397    ,
 1.4134681242169194    ,
 1.4162719619458888    ,
 1.4292955468852246    ,
 1.4948782235503542    ,
 1.5628769767028556    ,
 1.6278472133807649    ,
 1.6898869709451394    ,
 1.749114479120428     ,
 1.8056479648061736    ,
 1.8596086819412323    ,
 1.911123908716085     ,
 1.960329024738516     ,
 1.9982441017426211    ,
 1.999599902917909     ,
 1.9990055344249105    ,
 1.9979190161838585    ,
 1.8840792834701412    ,
 1.7320213575392007    ,
 1.5608352138043646    ,
 1.4610727255726       ,
 1.4610984090356491    ,
 1.4639331100942297    ,
 1.4795440957393444    ,
 1.5449295596084784    ,
 1.614842364583622     ,
 1.6818874869270262    ,
 1.745909387318633     ,
 1.8069939913128328    ,
 1.8652516445704248    ,
 1.9207959961239467    ,
 1.9737500834542006    ,
 2.0242483799736406    ,
 2.0634347183216835    ,
 2.063056816264279     ,
 2.0623782330190075    ,
 2.0616984490355827    ,
 1.9474296925153296    ,
 1.7913662433089022    ,
 1.6150178377902011    ,
 1.5130365929695095    ,
 1.5126276679553399    ,
 1.5156388630659872    ,
 1.5265464058483382    ,
 1.5901995939302687    ,
 1.6624279532097217    ,
 1.7319571968252192    ,
 1.798358832722326     ,
 1.8617038787996294    ,
 1.9220860108941884    ,
 1.979605757084082     ,
 2.034374256545475     ,
 2.086518527813789     ,
 2.1296266076030057    ,
 2.128798310347281     ,
 2.12800174313007      ,
 2.1221824317610287    ,
 1.9877370760323132    ,
 1.8265697612747387    ,
 1.642888657890281     ,
 1.5350108435114196    ,
 1.5344896507573016    ,
 1.5376535583977733    ,
 1.5550480100079962    ,
 1.6284985481047998    ,
 1.704576991089747     ,
 1.7775164572365127    ,
 1.8472389431391087    ,
 1.913797868599929     ,
 1.9772592933237596    ,
 2.0376957292533486    ,
 2.095193540015247     ,
 2.149857165729539     ,
 2.1909365838500996    ,
 2.1916086588248054    ,
 2.1909605057002883    ,
 2.1889959412463864    ,
 2.060807973651095     ,
 1.8926917230835287    ,
 1.6998215172710207    ,
 1.588564127838438     ,
 1.586711781774292     ,
 1.5897392791593794    ,
 1.6007687325605127    ,
 1.672601085459669     ,
 1.7515348360931555    ,
 1.8280041796958382    ,
 1.901295565782065     ,
 1.9713984483503626    ,
 2.038343130721001     ,
 2.1021641527410924    ,
 2.1629109353087808    ,
 2.220647476960233     ,
 2.263427727081927     ,
 2.264002215839371     ,
 2.2632651054706523    ,
 2.2625032277701487    ,
 2.1369909977922603    ,
 1.9599440543392215    ,
 1.755812344356507     ,
 1.6362319507516925    ,
 1.632706068496922     ,
 1.6353249884307983    ,
 1.6476805481768209    ,
 1.7200341418084528    ,
 1.802072139994766     ,
 1.8821350386291262    ,
 1.9591837075555067    ,
 2.033132721102035     ,
 2.103973242808037     ,
 2.1716991368808642    ,
 2.2363129397383923    ,
 2.297824630536172     ,
 2.3512315418665803    ,
 2.355097786541129     ,
 2.35475002156814      ,
 2.34859416928697      ,
 2.203048431600781     ,
 2.013883122419441     ,
 1.7950344704036378    ,
 1.665210083235302     ,
 1.659258092144689     ,
 1.6612950919487388    ,
 1.6719188939129448    ,
 1.744496178273708     ,
 1.8298981674283468    ,
 1.9138842513517442    ,
 1.9951553231109473    ,
 2.073563522520753     ,
 2.1490798295965194    ,
 2.221674235942923     ,
 2.2913061599413496    ,
 2.3579346305639       ,
 2.4106515253069145    ,
 2.4173743512032506    ,
 2.417875841956326     ,
 2.417304199322067     ,
 2.2821579521143263    ,
 2.078405091020862     ,
 1.8425112632936216    ,
 1.6946453005903446    ,
 1.6845891988763242    ,
 1.6856343314441067    ,
 1.699121961301231     ,
 1.7780773488787223    ,
 1.8661362109765542    ,
 1.9529458489245626    ,
 2.0373157904134778    ,
 2.1191194834303846    ,
 2.1983434771460977    ,
 2.274968162147935     ,
 2.348959410770732     ,
 2.4202680665191636    ,
 2.4781939479687325    ,
 2.4899390849153837    ,
 2.492010451964348     ,
 2.491415687301354     ,
 2.3442160170103854    ,
 2.12459019437981      ,
 1.871988163893115     ,
 1.7118287735801927    ,
 1.6987180544907121    ,
 1.6988711877037903    ]
eec = [0.20000059791878344		,
 0.21970860408072357       ,
 0.24133281072516768       ,
 0.2692756490916306        ,
 0.28680180475535516       ,
 0.2931168565730827        ,
 0.2994912853586104        ,
 0.3047804536928438        ,
 0.30145369470180644       ,
 0.2969074816171003        ,
 0.2917081158663698        ,
 0.2860895804981006        ,
 0.2802253674298259        ,
 0.274249112945725         ,
 0.2682593865396158        ,
 0.2623208259431523        ,
 0.2564817860783217        ,
 0.25130813364420407       ,
 0.25156110072663934       ,
 0.25170188417336226       ,
 0.25232452825674484       ,
 0.2710229924389587        ,
 0.295596915384172         ,
 0.3252406363662358        ,
 0.3468761310771789        ,
 0.34998052110083344       ,
 0.3530416069750035        ,
 0.3545095137100383        ,
 0.34907695881792317       ,
 0.34257320079402354       ,
 0.33578824367943905       ,
 0.3288537691411727        ,
 0.32187840569216786       ,
 0.3149359875337959        ,
 0.30807852993672513       ,
 0.3013433789164047        ,
 0.2947580626569219        ,
 0.2892456508516556        ,
 0.28882216251639814       ,
 0.2887518477756535        ,
 0.28880093148026403       ,
 0.30608379765546134       ,
 0.3313519328538651        ,
 0.3607429611975856        ,
 0.3781475730459007        ,
 0.3801751537688498        ,
 0.38195275464441997       ,
 0.38272380459442834       ,
 0.376910687196142         ,
 0.37011886092635016       ,
 0.3631938898972839        ,
 0.3561728063022715        ,
 0.34910142640721864       ,
 0.34202285456260484       ,
 0.3349775832701476        ,
 0.32800536344760745       ,
 0.3211411283271189        ,
 0.31514822851700275       ,
 0.31481284400379117       ,
 0.31471643972285707       ,
 0.3146692433434712        ,
 0.33163187685726314       ,
 0.3577510291051114        ,
 0.3876480782470937        ,
 0.40630310758577487       ,
 0.40821766671424925       ,
 0.4097616701144522        ,
 0.41027054762918097       ,
 0.40456549868457764       ,
 0.3975226173098668        ,
 0.3903035424384616        ,
 0.38296703695971934       ,
 0.3755617131405108        ,
 0.3681342715495566        ,
 0.3607272829110206        ,
 0.35338227392284344       ,
 0.34613672137089163       ,
 0.33999368611014397       ,
 0.3392940818755534        ,
 0.33917418722514575       ,
 0.33915237553566924       ,
 0.3574915761186094        ,
 0.3851493561955626        ,
 0.4166013249504745        ,
 0.4355943982223248        ,
 0.43756767330495233       ,
 0.43912931490582835       ,
 0.43954856528711184       ,
 0.4335675877682308        ,
 0.4262263645337638        ,
 0.4186847337694634        ,
 0.4110039103911493        ,
 0.40323263630391765       ,
 0.39542015617960674       ,
 0.3876128304580492        ,
 0.3798556330489594        ,
 0.37218835543645773       ,
 0.36556158900218455       ,
 0.36483517055656          ,
 0.36472133573627724       ,
 0.3647276122815588        ,
 0.3846395906760033        ,
 0.4140601898315395        ,
 0.4472531173282959        ,
 0.4681294368604569        ,
 0.4702584029779953        ,
 0.47193793603712975       ,
 0.473002296364381         ,
 0.46711496169603345       ,
 0.459381350788845         ,
 0.4514351731732162        ,
 0.44331964626690096       ,
 0.4350896651358152        ,
 0.42679706752374375       ,
 0.4184916109473244        ,
 0.4102213368840534        ,
 0.4020310607618934        ,
 0.3942817776682015        ,
 0.39308732020290926       ,
 0.39296825572577837       ,
 0.39319183214503745       ,
 0.4153119997947071        ,
 0.44672542987764036       ,
 0.48200287353564625       ,
 0.5083809152551229        ,
 0.510773033570167         ,
 0.5127131891584829        ,
 0.5135508703343397        ,
 0.5072691693589384        ,
 0.49916884009194834       ,
 0.49077161808320574       ,
 0.4821611529772932        ,
 0.47339575334284734       ,
 0.4645320030985563        ,
 0.45562499153810093       ,
 0.44672805035789515       ,
 0.4378912300109153        ,
 0.4298871224157983        ,
 0.4290776286482695        ,
 0.42894555453105776       ,
 0.4288723991219916        ,
 0.4503917096013663        ,
 0.48397799897895116       ,
 0.5214730136362737        ,
 0.5458694608086089        ,
 0.5485110838023508        ,
 0.5504923496832839        ,
 0.5516736355098418        ,
 0.5452366970829531        ,
 0.5368169466943734        ,
 0.5280895981941274        ,
 0.5191127815542036        ,
 0.509943090082445         ,
 0.5006386870239855        ,
 0.4912577932689931        ,
 0.4818586725988285        ,
 0.47249763521935645       ,
 0.46376125517270383       ,
 0.4621133097919826        ,
 0.4619496621272993        ,
 0.462203645191571         ,
 0.4888880895901654        ,
 0.5249450563496413        ,
 0.5648540523194782        ,
 0.5920428504852769        ,
 0.5948747438973777        ,
 0.5971203493924574        ,
 0.5976188717755555        ,
 0.5907730275213346        ,
 0.5821648480798288        ,
 0.5731493218049033        ,
 0.5638182049250507        ,
 0.5542348855873822        ,
 0.5444611032639234        ,
 0.5345589626796047        ,
 0.5245930297590893        ,
 0.5146252952673381        ,
 0.5062824072751766        ,
 0.5053661183687858        ,
 0.5051942974449206        ,
 0.5052921799814609        ,
 0.5322486873507285        ,
 0.5706295322691413        ,
 0.6126082437831664        ,
 0.6382097327689298        ,
 0.6415261550448494        ,
 0.6438847882334761        ,
 0.6449765372603753        ,
 0.6380433843823478        ,
 0.6293179809502226        ,
 0.6201491319104622        ,
 0.6106015275255157        ,
 0.6007350373404517        ,
 0.5906103485973182        ,
 0.5802928631044256        ,
 0.5698502984518296        ,
 0.5593515946900284        ,
 0.5497205640257526        ,
 0.5479731364630666        ,
 0.5477424212786978        ,
 0.5476114221874026        ,
 0.5730753199892216        ,
 0.6127612262186668        ,
 0.6555531116188865        ,
 0.6840233056860953        ,
 0.687836680495093         ,
 0.690328462585864         ,
 0.6912206051854354        ,
 0.6846910245272941        ,
 0.6761161203210699        ,
 0.6669824739467133        ,
 0.6573956419423537        ,
 0.6474159001464699        ,
 0.6371055440925648        ,
 0.6265265460196007        ,
 0.6157516338612404        ,
 0.6048519962676356        ,
 0.5946745866600407        ,
 0.5931045120829599        ,
 0.5928887978913628        ,
 0.5926959223003309        ,
 0.6182293668092359        ,
 0.6595010063535224        ,
 0.7030040944673183        ,
 0.7314444350341345        ,
 0.73543018864059          ,
 0.7379959497276012        ,
 0.7395217753883618        ,
 0.7339787873725828        ,
 0.7257679721257184        ,
 0.7168808997374585        ,
 0.7074653619737943        ,
 0.6975746936802019        ,
 0.6872622381975796        ,
 0.6765875702928137        ,
 0.6656200430377606        ,
 0.6544351126007101        ,
 0.643565102800971         ,
 0.6415579047299791        ,
 0.6413337901488728        ,
 0.641599857770015         ,
 0.6743633660892473        ,
 0.7171915726261985        ,
 0.7613882126950248        ,
 0.7901475049256729        ,
 0.7943781752646888        ,
 0.7972016206870762        ,
 0.7985005271381488        ,
 0.7926911311846754        ,
 0.7851446607131417        ,
 0.7769349748523185        ,
 0.7681177560999344        ,
 0.758724362054372         ,
 0.7487908922668611        ,
 0.7383641633659854        ,
 0.7275024696034238        ,
 0.7162765580708282        ,
 0.7056323672199916        ,
 0.7034973816491401        ,
 0.7030805675867174        ,
 0.7029127354011767        ,
 0.7319039228663963        ,
 0.7743042177051954        ,
 0.816578899768943         ,
 0.8428032309971718        ,
 0.8470696400633199        ,
 0.8498131402148349        ,
 0.8516727084875936        ,
 0.8474454881978338        ,
 0.8411274212804632        ,
 0.8340305547918989        ,
 0.8262771211472335        ,
 0.8178830475698555        ,
 0.8088605312430938        ,
 0.7992285495473964        ,
 0.7890203389125362        ,
 0.7782877904043999        ,
 0.7678821191065998        ,
 0.7656504767526665        ,
 0.7652206081088594        ,
 0.7649082350362687        ,
 0.7900295680787628        ,
 0.830449627439849         ,
 0.868698850099756         ,
 0.8917302571228573        ,
 0.8957269510121395        ,
 0.8982504523599967        ,
 0.8999009290121688        ,
 0.8968766281818071        ,
 0.8920438634214125        ,
 0.8864873107743488        ,
 0.8803006563436154        ,
 0.8734721201764569        ,
 0.865986185267722         ,
 0.8578243229787044        ,
 0.8489832592323385        ,
 0.8394786098621723        ,
 0.8295428486499482        ,
 0.8258938237730159        ,
 0.8251719408069802        ,
 0.8251021760419903        ,
 0.8520132596921113        ,
 0.8879438094923966        ,
 0.9194623364010761        ,
 0.9374635635984024        ,
 0.9409073822884763        ,
 0.9430033655624008        ,
 0.9444512931394896        ,
 0.9428153876244654        ,
 0.9398276299151466        ,
 0.9362868351131176        ,
 0.9322473800665955        ,
 0.9276803907574959        ,
 0.9225407720271946        ,
 0.9167799010215877        ,
 0.9103511792845105        ,
 0.9032135751231654        ,
 0.895681687985727         ,
 0.8927784218989938        ,
 0.8919260188901519        ,
 0.891500822443115         ,
 0.9080409350531315        ,
 0.9350629177813292        ,
 0.9569068082823627        ,
 0.9688546227810901        ,
 0.9712805978930622        ,
 0.9726695693861861        ,
 0.9735775525238124        ,
 0.9726770812993786        ,
 0.9711454897142622        ,
 0.9692899842903062        ,
 0.9671301976841815        ,
 0.964638782225769         ,
 0.9617733927792017        ,
 0.9584815583761234        ,
 0.9547048604597314        ,
 0.9503803182205034        ,
 0.9456352476771129        ,
 0.943350365379648         ,
 0.9425433658960695        ,
 0.9421525053430546        ,
 0.9530788285759837        ,
 0.9696150746718701        ,
 0.981652746134827         ,
 0.987714722248481         ,
 0.9890003560488415        ,
 0.9897183740966369        ]

pp.figure(10)
pp.plot(r.t[0:347],r.y[0,0:347],'-b',r.t[0:347],[x / 100 for x in m0c_d[0:347]],'-r')
pp.title('0th moment (D)')
pp.xlabel('t (s)',{"fontsize":16})
pp.ylabel('m0',{"fontsize":16})
pp.legend(('maxent','comsol'),loc=0)

pp.figure(11)
pp.plot(r.t[0:347],r.y[1,0:347],'-b',r.t[0:347],[x / 100 for x in m1c_d[0:347]],'-r')
pp.title('1ST moment (D)')
pp.xlabel('t (s)',{"fontsize":16})
pp.ylabel('m1',{"fontsize":16})
pp.legend(('maxent','comsol'),loc=0)

pp.figure(12)
pp.plot(r.t[0:347],r.y[2,0:347],'-b',r.t[0:347],[x / 100 for x in m2c_d[0:347]],'-r')
pp.title('2nd moment (D)')
pp.xlabel('t (s)',{"fontsize":16})
pp.ylabel('m2',{"fontsize":16})
pp.legend(('maxent','comsol'),loc=0)

pp.figure(13)
pp.plot(r.t[0:347],r.y[3,0:347],'-b',r.t[0:347],[x / 100 for x in m3c_d[0:347]],'-r')
pp.title('3rd moment (D)')
pp.xlabel('t (s)',{"fontsize":16})
pp.ylabel('m3',{"fontsize":16})
pp.legend(('maxent','comsol'),loc=0)

pp.figure(14)
pp.figure(figsize=[12, 10])
pp.plot(r.t[0:347],eet[0:347],'-b',r.t[0:347],eec[0:347],'-r')
pp.title('enantiomeric excess',{"fontsize":18})
pp.xlabel('time',{"fontsize":18})
pp.ylabel('ee',{"fontsize":18})
pp.legend(('Maxent','Finite elements(Comsol)'),loc='lower right',borderaxespad=0.1, fontsize=18)

'''t=20'''
Lmean_d = np.abs(r.y[1,resolution]/r.y[0,resolution])
σd = np.sqrt( np.abs(r.y[2,resolution]-2*Lmean_d*r.y[1,resolution]+Lmean_d**2*r.y[0,resolution])/r.y[0,resolution] )
Lmin_d = Lmean_d - 6*σd
Lmax_d = Lmean_d + 6*σd
bnds_d = [Lmin_d,Lmax_d]


pp.figure(8)
mulast_d=[r.y[0,347],r.y[1,347],r.y[2,347],r.y[3,347]]
sollast_d, lambdaslast=maxent_reconstruct_c0_1(mu=mulast_d,bnds=bnds_d)

'''reconstructed distribution from comsol moments at t=20'''
mu_comsol_d = [m0c_d[-1]/100,m1c_d[-1]/100,m2c_d[-1]/100,m3c_d[-1]/100]

sol_comsol_d, lambdas_comsol_d = maxent_reconstruct_c0_1(mu=mu_comsol_d,bnds=bnds_d)

L=np.linspace(0,2)
pp.plot(L,sollast_d(L),'-b,',L,sol_comsol_d(L),'-r,')
pp.title('t = 20')
pp.xlabel('L (μm)',{"fontsize":16})
pp.ylabel('n #/mLμL',{"fontsize":16})
pp.legend(('python fd','comsol fd'),loc=0)

