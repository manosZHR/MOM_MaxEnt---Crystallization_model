# -*- coding: utf-8 -*-
"""
Created on Tue May 10 22:52:22 2022

@author: Manos
"""

import time 
import numpy as np
from scipy.integrate import quad,solve_ivp
from numpy import sqrt, pi
import pylab as pp
from pymaxent import maxent_reconstruct_c0_1,maxent_reconstruct_c1_1,temp1,maxent_reconstruct_c0_2,maxent_reconstruct_c1_2,temp2
from plyer import notification

start = time.time()

'''Constants'''
a0 = 3.5e-4
kv = pi/6 
dens = 1300
q0 = 400
q1 = 2500
kr0 = 1e11
Er = 75000

lmeand0 = 0.5
lmeanl0 = 0.5
σd0 = 0.025
σl0 = 0.025

m3d0 = 0.062806
ratio = 1.5
m3l0 = m3d0/ratio

'''Αδιαστατοποίηση'''
Lr = 100e-6 
tr = 3600
Tr = 273
scale = 1e4

Eg = 12000
Ed = 12000
R = 8.314

T = 308

kb = 0.001
kg = 1e-4
kd = 2e-4

Kg = tr/Lr * kg*np.exp(-Eg/(R*T))
Kd = tr/Lr * kd*np.exp(-Ed/(R*T))
Kbg = kb*tr

tol1 = 1e-3
tol2 = 1e-4


'''Αρχικοποίση των μεταβλητών'''
tspan=(0, 30)
step = 0.2
resolution = int(tspan[1]/step)
teval = np.linspace(tspan[0],tspan[1],resolution+1)

initial_m_d=[]

for i in range(4):
    def f0_d(λ,i=i):
        return( λ**i* ( m3d0*lmeand0*(lmeand0**2+3*σd0**2)/(sqrt(2*pi*σd0)) * np.exp(-(λ-lmeand0)**2/(2*σd0**2)) )*scale )

    m, err = quad(f0_d, 0, np.inf)
    print('md(',i,')=',m)
    initial_m_d.append(m)


initial_m_l=[]

for i in range(4):
    def f0_l(λ,i=i):
        return( λ**i* ( m3l0*lmeanl0*(lmeanl0**2+3*σl0**2)/(sqrt(2*pi*σl0)) * np.exp(-(λ-lmeanl0)**2/(2*σl0**2)) )*scale )

    m, err = quad(f0_l, 0, np.inf)
    print('ml(',i,')=',m)
    initial_m_l.append(m)

Sd0 = 1
Sl0 = 1
initial_values = [initial_m_d[0],initial_m_d[1],initial_m_d[2],initial_m_d[3],initial_m_l[0],initial_m_l[1],initial_m_l[2],initial_m_l[3],Sd0,Sl0]

ee0 = ( initial_m_d[3] - initial_m_l[3] ) / ( initial_m_d[3] + initial_m_l[3] )


def cinf_d(T): return( q0*np.exp(-q1/T) )
def cinf_l(T): return( q0*np.exp(-q1/T) )

def γ_d(T): return( cinf_d(T)/(Lr**3*kv*dens) )
def γ_l(T): return( cinf_l(T)/(Lr**3*kv*dens) )


'''Growth Term'''
def G_d(Sd,T,L):
    jd =  Sd-1-a0/(L*Lr*T)
    if jd>0: 
        result = Kg * jd 
        return result
    else: 
        result = Kd * jd 
        return result

def G_l(Sl,T,L):
    jl =  Sl-1-a0/(L*Lr*T)
    if jl>0: 
        result = Kg * jl 
        return result
    else: 
        result = Kd * jl 
        return result
    
'''Daughter size distribution'''
q = 2
def g(L,λ): return( 3*L**2 * (2*q+1) * ( (2/(λ**3))**(2*q+1) ) * (L**3-(λ**3)/2)**(2*q) )


'''Agglomeration kernel'''
b0=1
def b(L,l):
    return b0
    

'''Racemization rate'''
def Rd(Sl,Sd,T):
    return( tr*kr0*np.exp(-Er/(R*T))*(Sl - Sd) )
def Rl(Sd,Sl,T):
    return( tr*kr0*np.exp(-Er/(R*T))*(Sd - Sl) )

def moments(t,y):
    m0_d=y[0]
    m1_d=y[1]
    m2_d=y[2]
    m3_d=y[3]
    m0_l=y[4]
    m1_l=y[5]
    m2_l=y[6]
    m3_l=y[7]
    Sd=y[8]
    Sl=y[9]

    print("\033[1;31m" + '''current time is''',t,'''s/''',tspan[1],'''s''')
    
    eet1 = (m3_d-m3_l)/(m3_d+m3_l)
    print('\033[32m'+'''enantiomeric excess is''',eet1)
    print('\033[39m')
    
    Lmean_d = np.abs(m1_d/m0_d)
    σd = np.sqrt( np.abs(m2_d-2*Lmean_d*m1_d+Lmean_d**2*m0_d)/m0_d )
    Lmean_l=m1_l/m0_l
    σl=np.sqrt( np.abs(m2_l-2*Lmean_l*m1_l+Lmean_l**2*m0_l)/m0_l )
    
    Lmin_d = max(0,Lmean_d - 5*σd)
    Lmax_d = Lmean_d + 6*σd
    Lmin_l = max(0,Lmean_l - 5*σl)
    Lmax_l = Lmean_l + 6*σl

    bnds_d=[Lmin_d,Lmax_d] 
    sol_d, lambdas_d= maxent_reconstruct_c1_1(mu=y[0:4] ,bnds=bnds_d)
    bnds_l=[Lmin_l,Lmax_l]
    sol_l, lambdas_l= maxent_reconstruct_c1_2(mu=y[4:8] ,bnds=bnds_l)
    
    '''Agg functions'''
    def Ad(L):
        def h1(l):
            u = (L**3-l**3)**(1/3)
            temp = b(u,l)/u**2*sol_d(u)*sol_d(l)
            return temp
        result = quad(h1,bnds_d[0],L,epsabs=1e-3)[0]
        return result
    def Al(L):
        def h2(l):
            u = (L**3-l**3)**(1/3)
            temp = b(u,l)/u**2*sol_l(u)*sol_l(l)
            return temp
        result = quad(h2,bnds_l[0],L,epsabs=1e-3)[0]
        return result
    
    def cd(L):
        def h3(l): return b(L,l)*sol_d(l)
        temp = quad(h3,bnds_d[0],bnds_d[1],epsabs=1e-3)[0]
        return temp
    def cl(L):
        def h4(l): return b(L,l)*sol_l(l)
        temp = quad(h4,bnds_l[0],bnds_l[1],epsabs=1e-3)[0]
        return temp
    
    
    def md(L,k):
        return L**(k+2)/2*Ad(L)-L**k*sol_d(L)*cd(L)
    def ml(L,k):
        return L**(k+2)/2*Al(L)-L**k*sol_l(L)*cl(L)
    
    k=0
    dm0dt_d = quad(md,bnds_d[0],bnds_d[1],epsabs=tol1,epsrel=tol2,args=(k))[0]
    dm0dt_l = quad(ml,bnds_l[0],bnds_l[1],epsabs=tol1,epsrel=tol2,args=(k))[0]
    k=1
    dm1dt_d = quad(md,bnds_d[0],bnds_d[1],epsabs=tol1,epsrel=tol2,args=(k))[0]
    dm1dt_l = quad(ml,bnds_l[0],bnds_l[1],epsabs=tol1,epsrel=tol2,args=(k))[0]
    k=2
    dm2dt_d = quad(md,bnds_d[0],bnds_d[1],epsabs=tol1,epsrel=tol2,args=(k))[0]
    dm2dt_l = quad(ml,bnds_l[0],bnds_l[1],epsabs=tol1,epsrel=tol2,args=(k))[0]
    k=3
    dm3dt_d = quad(md,bnds_d[0],bnds_d[1],epsabs=tol1,epsrel=tol2,args=(k))[0]
    dm3dt_l = quad(ml,bnds_l[0],bnds_l[1],epsabs=tol1,epsrel=tol2,args=(k))[0]

    
    dSddt = -1/(scale*Lr**3*γ_d(T))*dm3dt_d + Rd(Sd,Sl,T)
    dSldt = -1/(scale*Lr**3*γ_l(T))*dm3dt_l + Rl(Sd,Sl,T)
    
    print('[Lmin_d,Lmax_d] = ',[Lmin_d,Lmax_d])
    print('[Lmin_l,Lmax_l] = ',[Lmin_l,Lmax_l])
    print('dmkdt = \n',[dm0dt_d,dm0dt_l], '\n', [dm1dt_d,dm1dt_l], '\n', [dm2dt_d,dm2dt_l], '\n', [dm3dt_d,dm3dt_l])
    
    return(dm0dt_d,dm1dt_d,dm2dt_d,dm3dt_d,dm0dt_l,dm1dt_l,dm2dt_l,dm3dt_l,dSddt,dSldt)
    

r = solve_ivp(moments ,tspan, initial_values, method='BDF',t_eval=teval, jac=None, rtol=1e-3)


end=time.time()
print('''total time is ''', (end-start)/60, '''min''')

'''End of script notification'''

message= 'Script has finished running'
notification.notify(message= message,
                    app_icon = None,
                    timeout= 10,
                    toast=False)

'''Γράφημα εξέλιξης των ροπών'''
pp.figure(0)
pp.plot(r.t,r.y[0,:],'-b',r.t,r.y[4,:],'-g')
pp.xlabel('t(min)',{"fontsize":16})
pp.ylabel('m0(t)',{"fontsize":16})
pp.legend(('D','L'),loc=0)
pp.title('Evolution of zeroth moment')
pp.show()

pp.figure(1)
pp.plot(r.t,r.y[1,:],'-b',r.t,r.y[5,:],'-g')
pp.xlabel('t(min)',{"fontsize":16})
pp.ylabel('m1(t)',{"fontsize":16})
pp.legend(('D','L'),loc=0)
pp.title('Evolution of first moment')
pp.show()

pp.figure(2)
pp.plot(r.t,r.y[2,:],'-b',r.t,r.y[6,:],'-g')
pp.xlabel('t(min)',{"fontsize":16})
pp.ylabel('m2(t)',{"fontsize":16})
pp.legend(('D','L'),loc=0)
pp.title('Evolution of second moment')
pp.show()

pp.figure(3)
pp.plot(r.t,r.y[3,:],'-b',r.t,r.y[7,:],'-g')
pp.xlabel('t(min)',{"fontsize":16})
pp.ylabel('m3(t)',{"fontsize":16})
pp.legend(('D','L'),loc=0)
pp.title('Evolution of third moment')
pp.show()

'''Supersaturation'''
pp.figure(4)
pp.plot(r.t,r.y[8,:],'-')
pp.plot(r.t,r.y[9,:],'-')
pp.xlabel('t(min)',{"fontsize":16})
pp.ylabel('Supersaturations',{"fontsize":16})
pp.legend(('Sd','Sl'),loc=0)
pp.show()

'''Enantiomeric Excess'''
eet = (r.y[3,:] - r.y[7,:])/(r.y[3,:] + r.y[7,:])
pp.figure(5)
pp.plot(r.t,eet)
pp.xlabel('time',{"fontsize":16})
pp.ylabel('ee',{"fontsize":16})
pp.title('Evolution of enantiomeric excess',{"fontsize":16})
pp.show()




'''Σύγκριση με δεδομένα από μοντέλο Comsol'''

m0c_d = [12.501606973477273		,
 5.58655321770491          ,
 3.581464518665346         ,
 2.6286907738654866        ,
 2.0739907499793815        ,
 1.7118025856467711        ,
 1.4570366101544774        ,
 1.2681978287203737        ,
 1.12267971707057          ,
 1.0071319671618444        ,
 0.9131702468032431        ,
 0.8352667206525183        ,
 0.7696305157105267        ,
 0.7135758993372098        ,
 0.6651472891221474        ,
 0.6228871131876995        ,
 0.5856868827003873        ,
 0.5526886449184611        ,
 0.5232180198869261        ,
 0.49673761229316304       ,
 0.472813919631599         ,
 0.4510933874901342        ,
 0.43128479363372546       ,
 0.41314609140897796       ,
 0.39647445066673775       ,
 0.38109862493336566       ,
 0.3668730329689105        ,
 0.3536731242114731        ,
 0.34139171281355635       ,
 0.32993605294939327       ,
 0.3192254859114719        ,
 0.3091895327708488        ,
 0.299766337167669         ,
 0.29090138548194927       ,
 0.2825464483972819        ,
 0.2746587004322437        ,
 0.2671999834803684        ,
 0.26013618760734925       ,
 0.253436727888528         ,
 0.24707410034441707       ,
 0.24102350336700826       ,
 0.23526251363621295       ,
 0.2297708075926465        ,
 0.22452992116447168       ,
 0.21952304175713327       ,
 0.21473482756096304       ,
 0.21015125008148833       ,
 0.20575945648221416       ,
 0.2015476488917888        ,
 0.19750497828501706       ,
 0.19362145092467617       ,
 0.18988784566335898       ,
 0.18629564066173232       ,
 0.18283694829583186       ,
 0.17950445720486113       ,
 0.17629138058188276       ,
 0.1731914099365861        ,
 0.1701986736659           ,
 0.1673076998591835        ,
 0.1645133828411713        ,
 0.1618109530217454        ,
 0.15919594967711834       ,
 0.15666419633525225       ,
 0.15421177847918477       ,
 0.15183502331758536       ,
 0.14953048140212769       ,
 0.14729490989800628       ,
 0.1451252573365416        ,
 0.14301864969892222       ,
 0.14097237769742563       ,
 0.13898388513548687       ,
 0.13705075824139445       ,
 0.13517071588181184       ,
 0.13334160057159603       ,
 0.1315613702053191        ,
 0.12982809044376045       ,
 0.12813992769560165       ,
 0.12649514264074474       ,
 0.12489208424706158       ,
 0.12332918423727184       ,
 0.12180495196692188       ,
 0.12031796967823592       ,
 0.11886688809805872       ,
 0.11745042235111293       ,
 0.1160673481625297        ,
 0.11471649832603184       ,
 0.11339675941634178       ,
 0.1121070687263093        ,
 0.11084641141106656       ,
 0.1096138178230408        ,
 0.10840836102309728       ,
 0.10722915445440996       ,
 0.10607534976673662       ,
 0.10494613477990121       ,
 0.10384073157618642       ,
 0.10275839471221562       ,
 0.101698409541682         ,
 0.10066009064098642       ,
 0.09964278033058743       ,
 0.09864584728479033       ,
 0.09766868522520473       ,
 0.0967107116903088		,
 0.09577136687727378       ,
 0.09485011255065244       ,
 0.09394643101361051       ,
 0.09305982413716085       ,
 0.09218981244461248       ,
 0.09133593424630113       ,
 0.09049774482236843       ,
 0.08967481565013592       ,
 0.08886673367333371       ,
 0.0880731006103684        ,
 0.08729353229978845       ,
 0.08652765807982397       ,
 0.08577512020057597       ,
 0.08503557326662918       ,
 0.08430868370823529       ,
 0.0835941292794765        ,
 0.08289159858183896       ,
 0.08220079061149597       ,
 0.08152141432917111       ,
 0.08085318825119028       ,
 0.0801958400603992        ,
 0.0795491062361362        ,
 0.07891273170183041       ,
 0.07828646948944748       ,
 0.07767008041982557       ,
 0.07706333279803332       ,
 0.07646600212279447       ,
 0.07587787080958656       ,
 0.07529872792619624       ,
 0.07472836894043303       ,
 0.07416659547921227       ,
 0.07361321509846508       ,
 0.07306804106318258       ,
 0.07253089213737997       ,
 0.07200159238307001       ,
 0.07147997096808899       ,
 0.07096586198220645       ,
 0.07045910426112786       ,
 0.0699595412179948        ,
 0.06946702068202898       ,
 0.06898139474387928       ,
 0.06850251960757059       ,
 0.06803025544843753       ,
 0.06756446627697582       ,
 0.06710501980824578       ,
 0.06665178733657272       ,
 0.0662046436153026        ,
 0.06576346674136928       ,
 0.06532813804445742       ]
m0c_l = [8.335431087418106         ,
 4.570243888685997         ,
 3.14099908122766          ,
 2.3877929420554684        ,
 1.9235161061501564        ,
 1.6092506584281214        ,
 1.3827104785895425        ,
 1.2118200412413425        ,
 1.078398481168838         ,
 0.9713833689305378        ,
 0.8836645099869367        ,
 0.8104673291755562        ,
 0.7484687575582363        ,
 0.6952858754581754        ,
 0.6491656869051395        ,
 0.6087903039449735        ,
 0.5731500615741215        ,
 0.5414585115936074        ,
 0.5130940437685946        ,
 0.4875588979804537        ,
 0.4644498161921052        ,
 0.44343665222044654       ,
 0.4242465402774788        ,
 0.406651995236705         ,
 0.39046184520572014       ,
 0.37551428447479995       ,
 0.3616714418791586        ,
 0.3488151163097725        ,
 0.3368433904999618        ,
 0.32566792418521767       ,
 0.3152117631677289        ,
 0.30540755992946644       ,
 0.2961961222555938        ,
 0.2875252151993735        ,
 0.2793485681704147        ,
 0.2716250473867387        ,
 0.2643179624801864        ,
 0.2573944816215734        ,
 0.2508251373205625        ,
 0.24458340635877068       ,
 0.23864535097909714       ,
 0.23298931129793443       ,
 0.22759564060971404       ,
 0.22244647676120835       ,
 0.21752554399165672       ,
 0.21281798060514823       ,
 0.20831018862930364       ,
 0.20398970225671414       ,
 0.19984507238470428       ,
 0.19586576500478964       ,
 0.19204207154551153       ,
 0.1883650295422183		,
 0.1848263523007107        ,
 0.18141836636398528       ,
 0.17813395578424232       ,
 0.17496651237582625       ,
 0.17190989120849154       ,
 0.1689583706896918        ,
 0.16610661671442406       ,
 0.16334965039331684       ,
 0.1606828189561746        ,
 0.15810176946471297       ,
 0.1556024250352253        ,
 0.15318096328706593       ,
 0.15083379677662972       ,
 0.1485575552120417        ,
 0.1463490692602435        ,
 0.14420535578202118       ,
 0.14212360434839513       ,
 0.14010116491074137       ,
 0.13813553651727387       ,
 0.1362243569673502        ,
 0.13436539331574443       ,
 0.132556533146456         ,
 0.1307957765442199        ,
 0.12908122869956368       ,
 0.12741109308994297       ,
 0.12578366518509934       ,
 0.12419732662983389       ,
 0.12265053986325705       ,
 0.12114184313642891       ,
 0.1196698458942522        ,
 0.11823322449102561       ,
 0.116830718211842         ,
 0.11546112557465628       ,
 0.11412330089023008       ,
 0.1128161510590486        ,
 0.1115386325866498        ,
 0.11028974879996076       ,
 0.10906854724906281       ,
 0.10787411728015155       ,
 0.10670558776671514       ,
 0.105562124986915         ,
 0.10444293063640758       ,
 0.10334723996654326       ,
 0.10227432003886683       ,
 0.10122346808746954       ,
 0.10019400998142382       ,
 0.09918529878071639       ,
 0.09819671337787876       ,
 0.09722765722152205       ,
 0.09627755711377489       ,
 0.0953458620782438        ,
 0.09443204229309582       ,
 0.09353558808512494       ,
 0.09265600898033419       ,
 0.09179283280852271       ,
 0.0909456048567116        ,
 0.09011388706954737       ,
 0.08929725729319789       ,
 0.08849530856015052       ,
 0.08770764841195716       ,
 0.08693389825847278       ,
 0.08617369277029803       ,
 0.08542667930308206       ,
 0.08469251735156373       ,
 0.0839708780315101        ,
 0.0832614435879614        ,
 0.08256390692846438       ,
 0.08187797117932465       ,
 0.08120334926398477       ,
 0.08053976350211674       ,
 0.07988694522813694       ,
 0.07924463442836494       ,
 0.07861257939538262       ,
 0.07799053639891015       ,
 0.07737826937220507       ,
 0.07677554961319434       ,
 0.07618215549931587       ,
 0.07559787221586085       ,
 0.07502249149632435       ,
 0.07445581137478575       ,
 0.0738976359493917        ,
 0.07334777515647366       ,
 0.0728060445544912        ,
 0.07227226511791597       ,
 0.07174626303963953       ,
 0.07122786954228844       ,
 0.07071692069747355       ,
 0.07021325725280939       ,
 0.06971672446642249       ,
 0.06922717194838464       ,
 0.0687444535086974        ,
 0.06826842701178658       ,
 0.06779895423680968       ,
 0.06733590074381395       ,
 0.06687913574531995       ,
 0.06642853198311612       ,
 0.06598396560998786       ,
 0.06554531607617219       ,
 0.06511246602034258       ]
m1c_d = [6.251416519883944			,
 3.494796627861489         ,
 2.5475803713527165        ,
 2.0464343682191646        ,
 1.7312618903967927        ,
 1.5127219277753727        ,
 1.3512120028935457        ,
 1.226347491268125         ,
 1.126521343486556         ,
 1.0446177848026428        ,
 0.9760200117456753        ,
 0.9175948340170914        ,
 0.867136864687991         ,
 0.8230461300777554        ,
 0.7841319490683164        ,
 0.7494887617789626        ,
 0.7184148053438566        ,
 0.6903572623846337        ,
 0.6648743213236553        ,
 0.6416083392621399        ,
 0.6202664803756894        ,
 0.6006064990816476        ,
 0.5824261345265321        ,
 0.565555084428051         ,
 0.5498488525578415        ,
 0.5351839761584303        ,
 0.5214542821923708        ,
 0.508567922959287         ,
 0.49644500594498453       ,
 0.4850156832576171        ,
 0.47421859913103426       ,
 0.4639996191788065        ,
 0.45431078314591294       ,
 0.4451094363443728        ,
 0.43635750497645864       ,
 0.4280208881233245        ,
 0.42006894493128566       ,
 0.41247405994563785       ,
 0.405211272961203         ,
 0.3982579624200667        ,
 0.3915935734794249        ,
 0.3851993835194709        ,
 0.37905829917740314       ,
 0.3731546800392311        ,
 0.36747418496782147       ,
 0.3620036377253067        ,
 0.35673090910424593       ,
 0.35164481323279917       ,
 0.3467350160918906        ,
 0.34199195458733955       ,
 0.33740676477327586       ,
 0.3329712180339127        ,
 0.3286776642052809        ,
 0.3245189807662374        ,
 0.3204885273507766        ,
 0.3165801049379106        ,
 0.3127879191633723        ,
 0.30910654727171477       ,
 0.3055309082912629        ,
 0.30205623606813586       ,
 0.29867805484234977       ,
 0.2953921570884252        ,
 0.2921945833774907        ,
 0.2890816040471778        ,
 0.2860497024913767        ,
 0.2830955599038313        ,
 0.2802160413290495        ,
 0.27740818289054797       ,
 0.27466918008121727       ,
 0.2719963770133524        ,
 0.26938725653703544       ,
 0.2668394311455283        ,
 0.2643506345948686        ,
 0.2619187141725544        ,
 0.2595416235569692        ,
 0.25721741621507616       ,
 0.2549442392912858        ,
 0.2527203279450193        ,
 0.25054400009869127       ,
 0.24841365156153908       ,
 0.2463277514980469        ,
 0.24428483821262884       ,
 0.24228351522493402       ,
 0.24032244761246083       ,
 0.2384003585993054        ,
 0.23651602637178926       ,
 0.23466828110340116       ,
 0.23285600217305064       ,
 0.23107811556201707       ,
 0.22933359141624862       ,
 0.22762144176175833       ,
 0.22594071836196547       ,
 0.22429051070668243       ,
 0.222669944123347         ,
 0.22107817800185117       ,
 0.21951440412500536       ,
 0.21797784509731433       ,
 0.21646775286533787       ,
 0.21498340732349583       ,
 0.21352411499902996       ,
 0.21208920781223545       ,
 0.21067804190517883       ,
 0.20928999653578995       ,
 0.2079244730325765        ,
 0.20658089380623082       ,
 0.20525870141411565       ,
 0.20395735767534856       ,
 0.20267634283195957       ,
 0.20141515475430602       ,
 0.2001733081876533        ,
 0.1989503340375065        ,
 0.1977457786911592        ,
 0.1965592033739368        ,
 0.1953901835371954        ,
 0.1942383082769186        ,
 0.1931031797808791        ,
 0.19198441280268883       ,
 0.1908816341613258        ,
 0.18979448226472453       ,
 0.1887226066558481        ,
 0.18766566758026626       ,
 0.186623335573947         ,
 0.18559529107003853       ,
 0.18458122402395621       ,
 0.18358083355539484       ,
 0.18259382760659063       ,
 0.18161992261594323       ,
 0.18065884320619108       ,
 0.17971032188624078       ,
 0.17877409876633882       ,
 0.1778499212853722        ,
 0.1769375439500849        ,
 0.17603672808543852       ,
 0.17514724159562509       ,
 0.1742688587350529        ,
 0.17340135988915883       ,
 0.17254453136411854       ,
 0.17169816518534917       ,
 0.17086205890426356       ,
 0.17003601541287877       ,
 0.16921984276593038       ,
 0.1684133540101376        ,
 0.16761636702019284       ,
 0.16682870434140712       ,
 0.1660501930383775        ,
 0.16528066454964094       ,
 0.1645199545479502        ,
 0.16376790280592746       ,
 0.16302435306685928       ,
 0.1622891529203954        ,
 0.16156215368294563       ]
m1c_l = [4.167988254023327         ,
 2.6967482857019394        ,
 2.063687243873094         ,
 1.6984802315169476        ,
 1.457209645355049         ,
 1.2845637002933596        ,
 1.1542220989197234        ,
 1.0519280335663859        ,
 0.9692444593729855        ,
 0.9008438386905265        ,
 0.8431895643408208        ,
 0.7938378865412545        ,
 0.7510440558085807        ,
 0.713528047366586         ,
 0.6803275928232512        ,
 0.6507048177825979        ,
 0.624083944598714         ,
 0.60000872765921          ,
 0.578112679738566         ,
 0.5580978255622946        ,
 0.539719255954686         ,
 0.5227736976162334        ,
 0.5070909521540525        ,
 0.4925273533208807        ,
 0.4789606735401815        ,
 0.46628628029193997       ,
 0.4544140304131027        ,
 0.4432658188687149        ,
 0.4327736092123283        ,
 0.42287785281044643       ,
 0.41352617627269717       ,
 0.40467230877419286       ,
 0.3962752142396235        ,
 0.38829836159785985       ,
 0.38070911485751074       ,
 0.3734782207269463        ,
 0.3665793762328454        ,
 0.35998885814552944       ,
 0.35368521004823195       ,
 0.3476489746436794        ,
 0.34186246285289845       ,
 0.3363095544866406        ,
 0.3309755255297027        ,
 0.325846897950444         ,
 0.3209113086669667        ,
 0.316157394864793         ,
 0.3115746933095325        ,
 0.3071535516985019        ,
 0.3028850503774604        ,
 0.2987609330456539        ,
 0.2947735452802096        ,
 0.29091577977466043       ,
 0.2871810275884865        ,
 0.28356313453200144       ,
 0.2800563620364101        ,
 0.2766553520854347        ,
 0.2733550957071686        ,
 0.27015090451417806       ,
 0.26703838505783417       ,
 0.2640134156063609        ,
 0.2610721251165634        ,
 0.25821087412208804       ,
 0.25542623739720904       ,
 0.2527149881608457        ,
 0.25007408365685546       ,
 0.24750065200017893       ,
 0.24499198014923568       ,
 0.24254550289014706       ,
 0.24015879272493637       ,
 0.2378295505789956        ,
 0.23555559728304526       ,
 0.23333486572170392       ,
 0.23116539359810143       ,
 0.22904531675800313       ,
 0.22697286302294747       ,
 0.22494634648793616       ,
 0.22296416224366095       ,
 0.22102478148559176       ,
 0.21912674697501103       ,
 0.21726866882693632       ,
 0.2154492205955642        ,
 0.21366713563228823       ,
 0.21192120369459644       ,
 0.21021026778583018       ,
 0.2085332212074407        ,
 0.20688900480745126       ,
 0.20527660440895484       ,
 0.20369504840662056       ,
 0.20214340551705887       ,
 0.20062078267186229       ,
 0.1991263230430488        ,
 0.1976592041912484        ,
 0.19621863632734998       ,
 0.19480386068005193       ,
 0.19341414796136833       ,
 0.19204879692358634       ,
 0.19070713300099193       ,
 0.18938850703001425       ,
 0.18809229404509367       ,
 0.1868178921409402        ,
 0.1855647214007258        ,
 0.1843322228835797        ,
 0.18311985766838193       ,
 0.181927105949815         ,
 0.18075346618350646       ,
 0.17959845427727072       ,
 0.17846160282583237       ,
 0.17734246038528545       ,
 0.17624059078582827       ,
 0.17515557248005392       ,
 0.17408699792503513       ,
 0.17303447299509428       ,
 0.17199761642485242       ,
 0.17097605928016799       ,
 0.1699694444549237        ,
 0.16897742619273126       ,
 0.16799966963185767       ,
 0.16703585037179297       ,
 0.16608565406146014       ,
 0.16514877600620054       ,
 0.16422492079347076       ,
 0.1633138019360349        ,
 0.1624151415317521        ,
 0.16152866993893614       ,
 0.16065412546632624       ,
 0.1597912540773165        ,
 0.1589398091072702        ,
 0.1580995509936333        ,
 0.15727024701769185       ,
 0.15645167105820212       ,
 0.15564360335475264       ,
 0.15484583028202015       ,
 0.15405814413353924       ,
 0.15328034291485595       ,
 0.1525122301448287        ,
 0.15175361466654097       ,
 0.1510043104642872        ,
 0.15026413648954232       ,
 0.14953291649289027       ,
 0.1488104788629897        ,
 0.1480966564729446        ,
 0.14739128653232736       ,
 0.14669421044503142       ,
 0.14600527367286706       ,
 0.1453243256042646        ,
 0.14465121942831868       ,
 0.143985812013642         ,
 0.14332796379192497       ,
 0.14267753864581947       ,
 0.14203440380107107       ,
 0.14139842972288555       ]
m2c_d = [3.133907867775874		,
 2.295972060511499     ,
 1.9386799651199869    ,
 1.7222336822421314    ,
 1.5730729208454044    ,
 1.4623718764516935    ,
 1.3760016706227258    ,
 1.3061321700879442    ,
 1.248046747428412     ,
 1.1987196837048448    ,
 1.1561114319199142    ,
 1.1187913446390427    ,
 1.0857226883476103    ,
 1.0561335609605937    ,
 1.0294359266883966    ,
 1.0051729267967566    ,
 0.9829835071216367    ,
 0.9625780207060148    ,
 0.9437210077456254    ,
 0.9262187883799352    ,
 0.9099103592215665    ,
 0.894660603833329     ,
 0.8803551537032652    ,
 0.8668964455030915    ,
 0.8542006593302455    ,
 0.8421953141056328    ,
 0.8308173587814252    ,
 0.8200116435819024    ,
 0.8097296841347372    ,
 0.7999286545886928    ,
 0.7905705609737703    ,
 0.7816215578214442    ,
 0.7730513795418034    ,
 0.7648328644260268    ,
 0.7569415539315145    ,
 0.7493553535603753    ,
 0.7420542444399156    ,
 0.7350200368798377    ,
 0.7282361588712057    ,
 0.721687473818341     ,
 0.7153601228462347    ,
 0.7092413878597353    ,
 0.7033195722028761    ,
 0.6975838963041376    ,
 0.6920244061326383    ,
 0.686631892644864     ,
 0.6813978206943675    ,
 0.6763142661155902    ,
 0.6713738598918231    ,
 0.6665697384811778    ,
 0.6618954995112584    ,
 0.6573451621680474    ,
 0.6529131316999002    ,
 0.6485941675389137    ,
 0.6443833546099305    ,
 0.6402760774553644    ,
 0.6362679968534141    ,
 0.632355028648904     ,
 0.6285333245522037    ,
 0.6247992546921788    ,
 0.6211493917358125    ,
 0.6175804964097579    ,
 0.6140895042789714    ,
 0.6106735136544981    ,
 0.6073297745174742    ,
 0.6040556783591525    ,
 0.6008487488481792    ,
 0.5977066332460583    ,
 0.5946270945004594    ,
 0.5916080039535443    ,
 0.5886473346091415    ,
 0.585743154908512     ,
 0.5828936229695649    ,
 0.5800969812489932    ,
 0.5773515515908945    ,
 0.5746557306289565    ,
 0.5720079855125684    ,
 0.5694068499300533    ,
 0.5668509204047169    ,
 0.5643388528417377    ,
 0.5618693593059443    ,
 0.5594412050122949    ,
 0.557053205512605     ,
 0.5547042240634239    ,
 0.5523931691614239    ,
 0.550118992233662     ,
 0.5478806854713945    ,
 0.5456772797968523    ,
 0.5435078429534462    ,
 0.5413714777105627    ,
 0.5392673201748692    ,
 0.5371945382007102    ,
 0.5351523298927477    ,
 0.5331399221945428    ,
 0.5311565695573093    ,
 0.5292015526834402    ,
 0.5272741773399074    ,
 0.5253737732369447    ,
 0.5234996929678767    ,
 0.5216513110056941    ,
 0.519828022753971     ,
 0.5180292436471412    ,
 0.516254408298233     ,
 0.5145029696906874    ,
 0.5127743984116877    ,
 0.5110681819241704    ,
 0.5093838238760701    ,
 0.5077208434434178    ,
 0.5060787747061952    ,
 0.50445716605469      ,
 0.5028555796246749    ,
 0.5012735907595645    ,
 0.4997107874985811    ,
 0.4981667700887009    ,
 0.49664115051964397   ,
 0.49513355208042426   ,
 0.49364360893624765   ,
 0.4921709657247533    ,
 0.49071527717058433   ,
 0.48927620771710767   ,
 0.4878534311746083    ,
 0.4864466303840043    ,
 0.4850554968951727    ,
 0.48367973065942305   ,
 0.48231903973507406   ,
 0.4809731400056149    ,
 0.47964175490986094   ,
 0.4783246151834458    ,
 0.4770214586109828    ,
 0.4757320297887347    ,
 0.4744560798967883    ,
 0.47319336648062804   ,
 0.47194365324154214   ,
 0.4707067098354474    ,
 0.46948231167964677   ,
 0.46827023976742593   ,
 0.4670702804897314    ,
 0.46588222546390984   ,
 0.46470587136904823   ,
 0.4635410197876501    ,
 0.46238747705335265   ,
 0.46124505410442396   ,
 0.4601135663427059    ,
 0.4589928334979738    ,
 0.45788267949718153   ,
 0.45678293233859774   ,
 0.4556934239705394    ,
 0.45461399017451093   ,
 0.453544470452562     ,
 0.4524847079186906    ,
 0.4514345491941148    ]
m2c_l = [2.0893755431668346    ,
 1.654156681631868     ,
 1.4348920092341761    ,
 1.2925338787352327    ,
 1.1898941147957065    ,
 1.111352671531673     ,
 1.0487824422040175    ,
 0.9974312249444173    ,
 0.9543024812451885    ,
 0.9174033539240638    ,
 0.8853528383655872    ,
 0.8571611550813925    ,
 0.8320996154589733    ,
 0.8096200591583592    ,
 0.7892991037625852    ,
 0.7708045286367362    ,
 0.7538716397818703    ,
 0.7382866594617794    ,
 0.723874782836195     ,
 0.7104915021898007    ,
 0.6980161973813441    ,
 0.6863472855532129    ,
 0.6753985911692821    ,
 0.6650964469048722    ,
 0.6553772368225385    ,
 0.6461859020683333    ,
 0.6374744704894875    ,
 0.6292009328193401    ,
 0.6213283204325439    ,
 0.6138239921537392    ,
 0.6066589594647981    ,
 0.5998073411218753    ,
 0.5932459736196619    ,
 0.5869540539900204    ,
 0.5809128387779937    ,
 0.5751053896775229    ,
 0.569516358798283     ,
 0.5641317903927854    ,
 0.5589389628282937    ,
 0.5539262535560981    ,
 0.5490830192635949    ,
 0.5443994916986826    ,
 0.5398666867612839    ,
 0.5354763248794465    ,
 0.5312207610752492    ,
 0.5270929233787317    ,
 0.523086258381921     ,
 0.519194683024636     ,
 0.5154125416969285    ,
 0.5117345680742864    ,
 0.5081558511775178    ,
 0.5046718046800853    ,
 0.5012781398055194    ,
 0.4979708407696274    ,
 0.4947461423854053    ,
 0.49160051010403594   ,
 0.48853062214988147   ,
 0.4855333530097496    ,
 0.4826057587050702    ,
 0.4797450632772451    ,
 0.4769486465459667    ,
 0.47421403281204777   ,
 0.4715388807308137    ,
 0.468920973992637     ,
 0.46635821270636774   ,
 0.46384860557067065   ,
 0.46139026269400707   ,
 0.458981388984969     ,
 0.4566202780146851    ,
 0.4543053063178067    ,
 0.4520349282610557    ,
 0.4498076712460094    ,
 0.44762213127364403   ,
 0.44547696883525606   ,
 0.44337090510027      ,
 0.44130271837902735   ,
 0.4392712408407146    ,
 0.4372753554592852    ,
 0.4353139931579777    ,
 0.4333861301614034    ,
 0.43149078552651254   ,
 0.42962701883527055   ,
 0.4277939280385279    ,
 0.4259906474400199    ,
 0.4242163458090431    ,
 0.42247022461434797   ,
 0.4207515163641162    ,
 0.419059483054497     ,
 0.41739341471032715   ,
 0.4157526280128716    ,
 0.41413646501063217   ,
 0.41254429190687747   ,
 0.4109754979163726    ,
 0.4094294941899698    ,
 0.40790571279957255   ,
 0.4064036057815906    ,
 0.4049226442329302    ,
 0.40346231745211714   ,
 0.4020221321397977    ,
 0.400601611630408     ,
 0.39920029516940564   ,
 0.39781773723086544   ,
 0.3964535068692809    ,
 0.39510718710433973   ,
 0.39377837433684193   ,
 0.3924666777975304    ,
 0.39117171902143855   ,
 0.3898931313488142    ,
 0.38863055945057273   ,
 0.38738365887702325   ,
 0.3861520956304826    ,
 0.3849355457549054    ,
 0.38373369494634857   ,
 0.3825462381853162    ,
 0.381372879382273     ,
 0.3802133310412179    ,
 0.3790673139386759    ,
 0.3779345568147481    ,
 0.3768147960836877    ,
 0.37570777555334905   ,
 0.3746132461577909    ,
 0.3735309657017797    ,
 0.37246069861787995   ,
 0.3714022157321874    ,
 0.3703552940401905    ,
 0.3693197164935133    ,
 0.3682952717943503    ,
 0.3672817542000422    ,
 0.3662789633348448    ,
 0.3652867040113354    ,
 0.36430478605467553   ,
 0.3633330241376205    ,
 0.36237123762135176   ,
 0.36141925040388695   ,
 0.3604768907715091    ,
 0.3595439912630786    ,
 0.35862038852938577   ,
 0.3577059232068124    ,
 0.3568004397882983    ,
 0.355903786500643     ,
 0.3550158151923557    ,
 0.35413638122237046   ,
 0.3532653433531391    ,
 0.3524025636473775    ,
 0.35154790736817115   ,
 0.35070124288367394   ,
 0.34986244157497903   ,
 0.3490313777476623    ,
 0.3482079285456888    ,
 0.3473919738683458    ,
 0.34658339629134416   ]
m3c_d = [1.5750116899882964		,
 1.5872358467905512        ,
 1.5748183580519683        ,
 1.5579274776801455        ,
 1.5428058262731776        ,
 1.5302135704714661        ,
 1.5197876265597121        ,
 1.5110630334870256        ,
 1.5036607322083713        ,
 1.4972943689782268        ,
 1.491749407505937         ,
 1.4868639562629367        ,
 1.4825146052647165        ,
 1.4786062781509208        ,
 1.4750649326185963        ,
 1.4718322677184572        ,
 1.4688618623940062        ,
 1.4661163430282387        ,
 1.4635652955532732        ,
 1.4611837166938157        ,
 1.458950856570825         ,
 1.4568493460775849        ,
 1.4548645323249518        ,
 1.452983966925091         ,
 1.4511970075396314        ,
 1.4494945040109557        ,
 1.4478685482757507        ,
 1.4463122731396458        ,
 1.4448196887033422        ,
 1.443385548298374         ,
 1.4420052377540906        ,
 1.4406746833367015        ,
 1.4393902747772997        ,
 1.438148800603958         ,
 1.4369473935845247        ,
 1.4357834845344797        ,
 1.4346547630848008        ,
 1.4335591442684315        ,
 1.432494739990963         ,
 1.431459834614576         ,
 1.4304528640162133        ,
 1.4294723975869439        ,
 1.4285171227267612        ,
 1.427585831460333         ,
 1.4266774088587542        ,
 1.4257908230011522        ,
 1.4249251162517627        ,
 1.4240793976619317        ,
 1.4232528363360826        ,
 1.4224446556245463        ,
 1.4216541280271524        ,
 1.4208805707086272        ,
 1.4201233415415286        ,
 1.4193818356050445        ,
 1.418655482078335         ,
 1.4179437414760931        ,
 1.4172461031815642        ,
 1.416562083238756         ,
 1.4158912223708324        ,
 1.4152330841966034        ,
 1.4145872536206714        ,
 1.4139533353764473        ,
 1.4133309527038234        ,
 1.4127197461460115        ,
 1.4121193724519603        ,
 1.4115295035725437        ,
 1.4109498257404527        ,
 1.4103800386246705        ,
 1.409819854551976         ,
 1.4092689977884894        ,
 1.4087272038753567        ,
 1.408194219013267         ,
 1.4076697994912184        ,
 1.4071537111554002        ,
 1.4066457289145051        ,
 1.4061456362783635        ,
 1.4056532249268494        ,
 1.4051682943067116        ,
 1.4046906512537867        ,
 1.4042201096387614        ,
 1.4037564900344308        ,
 1.4032996194029494        ,
 1.4028493308014551        ,
 1.4024054631047247        ,
 1.4019678607436745        ,
 1.4015363734584858        ,
 1.4011108560654169        ,
 1.400691168236303         ,
 1.4002771742899314        ,
 1.3998687429944348        ,
 1.3994657473801009        ,
 1.3990680645618123        ,
 1.3986755755705547        ,
 1.3982881651934698        ,
 1.3979057218218607        ,
 1.3975281373066994        ,
 1.3971553068212246        ,
 1.3967871287301532        ,
 1.3964235044651523        ,
 1.396064338406181         ,
 1.3957095377685098        ,
 1.395359012494843         ,
 1.3950126751525158        ,
 1.3946704408353279        ,
 1.3943322270698648        ,
 1.3939979537259386        ,
 1.3936675429311394        ,
 1.3933409189890287        ,
 1.393018008301002         ,
 1.392698739291465         ,
 1.392383042336325         ,
 1.392070849694431         ,
 1.3917620954420298        ,
 1.3914567154098922        ,
 1.3911546471231198        ,
 1.3908558297434268        ,
 1.3905602040137905        ,
 1.3902677122053893        ,
 1.3899782980666913        ,
 1.389691906774561         ,
 1.3894084848873784        ,
 1.389127980299985         ,
 1.3888503422003868        ,
 1.3885755210282575        ,
 1.388303468434927         ,
 1.3880341372450105        ,
 1.3877674814195038        ,
 1.3875034560202304        ,
 1.3872420171757127        ,
 1.3869831220483062        ,
 1.38672672880253          ,
 1.3864727965746488        ,
 1.3862212854432885        ,
 1.3859721564012517        ,
 1.3857253713282287        ,
 1.3854808929646274        ,
 1.3852386848862612        ,
 1.3849987114799844        ,
 1.3847609379201926        ,
 1.3845253301461506        ,
 1.3842918548401217        ,
 1.384060479406264         ,
 1.3838311719502723        ,
 1.383603901259699         ,
 1.3833786367849767        ,
 1.3831553486210937        ,
 1.3829340074898748        ,
 1.3827145847228457        ,
 1.3824970522447255        ,
 1.3822813825574352        ,
 1.3820675487246294        ]
m3c_l = [1.0500060889555205		,
 1.0580619289046518        ,
 1.0564425686042884        ,
 1.0499805606786978        ,
 1.042427338581941         ,
 1.0351838935120241        ,
 1.028655929234031         ,
 1.0228908952600049        ,
 1.0178177335626515        ,
 1.0133390084241736        ,
 1.0093615763780983        ,
 1.0058044206523127        ,
 1.0026018834386643        ,
 0.9997045853856866        ,
 0.9970689033065403        ,
 0.994658365854863         ,
 0.9924426410325244        ,
 0.9903964996430078        ,
 0.9884987512763758        ,
 0.9867314937479482        ,
 0.9850795832626643        ,
 0.9835301181351387        ,
 0.9820722825265048        ,
 0.9806968893352652        ,
 0.9793953355514905        ,
 0.9781603436019378        ,
 0.9769855715214713        ,
 0.9758655024400232        ,
 0.9747953202683891        ,
 0.9737709496051408        ,
 0.9727887779142211        ,
 0.9718454695434974        ,
 0.970938043474689         ,
 0.9700638303808756        ,
 0.9692204371831878        ,
 0.9684057200220141        ,
 0.9676177692506305        ,
 0.9668548373504691        ,
 0.9661153266614861        ,
 0.9653977844560587        ,
 0.9647008869620934        ,
 0.9640234256122215        ,
 0.9633642949841401        ,
 0.962722482077691         ,
 0.9620970568769888        ,
 0.9614871641586666        ,
 0.9608920160829512        ,
 0.9603108857582161        ,
 0.9597431011834062        ,
 0.9591880400490566        ,
 0.9586451257386447        ,
 0.9581138221694743        ,
 0.9575936312364847        ,
 0.9570840895387109        ,
 0.9565847641632977        ,
 0.9560952499937879        ,
 0.9556151682254947        ,
 0.9551441633604717        ,
 0.9546819017701823        ,
 0.9542280697488256        ,
 0.9537823720562472        ,
 0.9533445299134654        ,
 0.9529142801404457        ,
 0.9524913740847646        ,
 0.9520755762322283        ,
 0.9516666633170352        ,
 0.9512644235646376        ,
 0.9508686559592806        ,
 0.9504791693179736        ,
 0.950095781232022         ,
 0.9497183177530698        ,
 0.9493466128233605        ,
 0.9489805077713473        ,
 0.948619850841375         ,
 0.9482644967481773        ,
 0.9479143062729556        ,
 0.9475691459152323        ,
 0.9472288875622312        ,
 0.9468934081154848        ,
 0.9465625892158848        ,
 0.9462363169933891        ,
 0.945914481821513         ,
 0.9455969780876461        ,
 0.945283703981485         ,
 0.9449745612949527        ,
 0.9446694552465793        ,
 0.9443682942918438        ,
 0.9440709899807896        ,
 0.9437774568106151        ,
 0.9434876120791169        ,
 0.9432013757561938        ,
 0.94291867036587          ,
 0.9426394208658088        ,
 0.9423635545457616        ,
 0.9420910009256251        ,
 0.9418216916664411        ,
 0.9415555604811391        ,
 0.9412925430167015        ,
 0.9410325768251566        ,
 0.9407756012596981        ,
 0.9405215573979864        ,
 0.9402703879888973        ,
 0.9400220373885383        ,
 0.9397764514949426        ,
 0.9395335776819826        ,
 0.9392933647599782        ,
 0.9390557629183285        ,
 0.9388207236767657        ,
 0.9385881998356636        ,
 0.9383581454290608        ,
 0.9381305156919337        ,
 0.9379052670076929        ,
 0.93768235686287          ,
 0.9374617438290119        ,
 0.9372433875176204        ,
 0.937027248547434         ,
 0.9368132885133347        ,
 0.936601469938132         ,
 0.9363917562639033        ,
 0.9361841118165208        ,
 0.935978501775456         ,
 0.9357748921453688        ,
 0.9355732497393556        ,
 0.9353735421486256        ,
 0.9351757377147379        ,
 0.9349798055114817        ,
 0.9347857153177453        ,
 0.9345934376024226        ,
 0.9344029435035593        ,
 0.9342142048184707        ,
 0.9340271939676985        ,
 0.9338418839821643        ,
 0.9336582484857628        ,
 0.9334762616857026        ,
 0.9332958983449046        ,
 0.9331171337993929        ,
 0.9329399439086671        ,
 0.9327643050662894        ,
 0.9325901941596055        ,
 0.9324175885405098        ,
 0.9322464660352335        ,
 0.9320768049317301        ,
 0.9319085839693347        ,
 0.9317417823254956        ,
 0.9315763796008328        ,
 0.9314123558103881        ,
 0.9312496913732314        ,
 0.9310883671046319        ,
 0.9309283642028375        ,
 0.9307696642358191        ,
 0.9306122491368776        ]


diff_m3=[]
zip_object = zip(m3c_d, m3c_l)
for m3c_d_i, m3c_l_i in zip_object:
    diff_m3.append(m3c_d_i-m3c_l_i)
sum_m3 = [sum(x) for x in zip(m3c_d, m3c_l)]

eec = [m/n for m, n in zip(diff_m3,sum_m3)]


pp.figure(9)
#Change the figure size
pp.figure(figsize=[16, 12])
pp.subplot(2,2,1)
pp.plot(r.t,r.y[0,:]/initial_m_d[0],'.r',r.t,np.array(m0c_d)/initial_m_d[0],'-b')
pp.xlabel('time',{"fontsize":16})
pp.ylabel('m0(t)/m0(0)',{"fontsize":16})
pp.legend(('Maximum Entropy','Finite Elements (Comsol)'),loc='upper right',borderaxespad=0.1, fontsize=15)
pp.title('(a) Evolution of zeroth moment',fontsize=15)
pp.subplot(2,2,2)
pp.plot(r.t,r.y[1,:]/initial_m_d[1],'.r',r.t,np.array(m1c_d)/initial_m_d[1],'-b')
pp.xlabel('time',{"fontsize":16})
pp.ylabel('m1(t)/m1(0)',{"fontsize":16})
pp.title('(b) Evolution of first moment',fontsize=15)
pp.legend(('Maximum Entropy','Finite Elements (Comsol)'),loc='upper right',borderaxespad=0.1, fontsize=15)
pp.subplot(2,2,3)
pp.plot(r.t,r.y[2,:]/initial_m_d[2],'.r',r.t,np.array(m2c_d)/initial_m_d[2],'-b')
pp.xlabel('time',{"fontsize":16})
pp.ylabel('m2(t)/m2(0)',{"fontsize":16})
pp.title('(c) Evolution of second moment',fontsize=15)
pp.legend(('Maximum Entropy','Finite Elements (Comsol)'),loc='upper right',borderaxespad=0.1, fontsize=15)
pp.subplot(2,2,4)
pp.plot(r.t,r.y[3,:]/initial_m_d[3],'.r',r.t,np.array(m3c_d)/initial_m_d[3],'-b')
pp.ylim([0.8, 1.2])
pp.xlabel('time',{"fontsize":16})
pp.ylabel('m3(t)/m3(0)',{"fontsize":16})
pp.title('(d) Evolution of third moment',fontsize=15)
pp.legend(('Maximum Entropy','Finite Elements (Comsol)'),loc='lower right',borderaxespad=0.1, fontsize=15)
pp.suptitle('Enantiomer D', x=0.5, y=0.95, fontsize=17, fontweight='700',)

pp.figure(10)
#Change the figure size
pp.figure(figsize=[16, 12])
pp.subplot(2,2,1)
pp.plot(r.t,r.y[4,:]/initial_m_l[0],'.r',r.t,np.array(m0c_l)/initial_m_l[0],'-b')
pp.xlabel('time',{"fontsize":16})
pp.ylabel('m0(t)/m0(0)',{"fontsize":16})
pp.legend(('Maximum Entropy','Finite Elements (Comsol)'),loc='upper right',borderaxespad=0.1, fontsize=15)
pp.title('(a) Evolution of zeroth moment',fontsize=15)
pp.subplot(2,2,2)
pp.plot(r.t,r.y[5,:]/initial_m_l[1],'.r',r.t,np.array(m1c_l)/initial_m_l[1],'-b')
pp.xlabel('time',{"fontsize":16})
pp.ylabel('m1(t)/m1(0)',{"fontsize":16})
pp.title('(b) Evolution of first moment',fontsize=15)
pp.legend(('Maximum Entropy','Finite Elements (Comsol)'),loc='upper right',borderaxespad=0.1, fontsize=15)
pp.subplot(2,2,3)
pp.plot(r.t,r.y[6,:]/initial_m_l[2],'.r',r.t,np.array(m2c_l)/initial_m_l[2],'-b')
pp.xlabel('time',{"fontsize":16})
pp.ylabel('m2(t)/m2(0)',{"fontsize":16})
pp.title('(c) Evolution of second moment',fontsize=15)
pp.legend(('Maximum Entropy','Finite Elements (Comsol)'),loc='upper right',borderaxespad=0.1, fontsize=15)
pp.subplot(2,2,4)
pp.plot(r.t,r.y[7,:]/initial_m_l[3],'.r',r.t,np.array(m3c_l)/initial_m_l[3],'-b')
pp.ylim([0.8, 1.2])
pp.xlabel('time',{"fontsize":16})
pp.ylabel('m3(t)/m3(0)',{"fontsize":16})
pp.title('(d) Evolution of third moment',fontsize=15)
pp.legend(('Maximum Entropy','Finite Elements (Comsol)'),loc='lower right',borderaxespad=0.1, fontsize=15)
pp.suptitle('Enantiomer L', x=0.5, y=0.95, fontsize=17, fontweight='700')

'''Σχετικό Σφάλμα χρονικής εξέλιξης ροπών'''
err0_d=[]
for i in range(len(r.y[0,:])): 
    err = np.abs(r.y[0,i]/initial_m_d[0]-m0c_d[i]/initial_m_d[0])/(m0c_d[i]/initial_m_d[0])*100
    err0_d.append(err)

err1_d=[]
for i in range(len(r.y[1,:])): 
    err = np.abs(r.y[1,i]/initial_m_d[1]-m1c_d[i]/initial_m_d[1])/(m1c_d[i]/initial_m_d[1])*100
    err1_d.append(err)
    
err2_d=[]
for i in range(len(r.y[2,:])): 
    err = np.abs(r.y[2,i]/initial_m_d[2]-m2c_d[i]/initial_m_d[2])/(m2c_d[i]/initial_m_d[2])*100
    err2_d.append(err)

err3_d=[]
for i in range(len(r.y[3,:])): 
    err = np.abs(r.y[3,i]/initial_m_d[3]-m3c_d[i]/initial_m_d[3])/(m3c_d[i]/initial_m_d[3])*100
    err3_d.append(err)
    
pp.figure(11)
#Change the figure size
pp.figure(figsize=[16, 12])
pp.subplot(2,2,1)
pp.plot(r.t,err0_d)
pp.xlabel('time',{"fontsize":16})
pp.ylabel('percentage error',{"fontsize":16})
pp.title('(a) Zeroth moment',fontsize=15)
pp.subplot(2,2,2)
pp.plot(r.t,err1_d)
pp.xlabel('time',{"fontsize":16})
pp.ylabel('percentage error',{"fontsize":16})
pp.title('(b) First moment',fontsize=15)
pp.subplot(2,2,3)
pp.plot(r.t,err2_d)
pp.xlabel('time',{"fontsize":16})
pp.ylabel('percentage error',{"fontsize":16})
pp.title('(c) Second moment',fontsize=15)
pp.subplot(2,2,4)
pp.plot(r.t,err3_d)
pp.xlabel('time',{"fontsize":16})
pp.ylabel('percentage error',{"fontsize":16})
pp.title('(d) Third moment',fontsize=15)
pp.suptitle('Enantiomer D', x=0.5, y=0.95, fontsize=17, fontweight='700',)


err0_l=[]
for i in range(len(r.y[4,:])): 
    err = np.abs(r.y[4,i]/initial_m_l[0]-m0c_l[i]/initial_m_l[0])/(m0c_l[i]/initial_m_l[0])*100
    err0_l.append(err)

err1_l=[]
for i in range(len(r.y[5,:])): 
    err = np.abs(r.y[5,i]/initial_m_l[1]-m1c_l[i]/initial_m_l[1])/(m1c_l[i]/initial_m_l[1])*100
    err1_l.append(err)
    
err2_l=[]
for i in range(len(r.y[6,:])): 
    err = np.abs(r.y[6,i]/initial_m_l[2]-m2c_l[i]/initial_m_l[2])/(m2c_l[i]/initial_m_l[2])*100
    err2_l.append(err)

err3_l=[]
for i in range(len(r.y[7,:])): 
    err = np.abs(r.y[7,i]/initial_m_l[3]-m3c_l[i]/initial_m_l[3])/(m3c_l[i]/initial_m_l[3])*100
    err3_l.append(err)
    
pp.figure(12)
#Change the figure size
pp.figure(figsize=[16, 12])
pp.subplot(2,2,1)
pp.plot(r.t,err0_l)
pp.xlabel('time',{"fontsize":16})
pp.ylabel('percentage error',{"fontsize":16})
pp.title('(a) Zeroth moment',fontsize=15)
pp.subplot(2,2,2)
pp.plot(r.t,err1_l)
pp.xlabel('time',{"fontsize":16})
pp.ylabel('percentage error',{"fontsize":16})
pp.title('(b) First moment',fontsize=15)
pp.subplot(2,2,3)
pp.plot(r.t,err2_l)
pp.xlabel('time',{"fontsize":16})
pp.ylabel('percentage error',{"fontsize":16})
pp.title('(c) Second moment',fontsize=15)
pp.subplot(2,2,4)
pp.plot(r.t,err3_l)
pp.xlabel('time',{"fontsize":16})
pp.ylabel('percentage error',{"fontsize":16})
pp.title('(d) Third moment',fontsize=15)
pp.suptitle('Enantiomer L', x=0.5, y=0.95, fontsize=17, fontweight='700',)


'''Κατανομές maxent και comsol για την τελευταία χρονική στιγμή'''
Lmin=0
Lmax=6
bnds=[Lmin,Lmax]

pp.figure(13)
pp.figure(figsize=[10, 8])
mulast_d=[r.y[0,-1],r.y[1,-1],r.y[2,-1],r.y[3,-1]]
sollast_d, lambdaslast=maxent_reconstruct_c0_1(mu=mulast_d,bnds=bnds)

mulast_l=[r.y[4,-1],r.y[5,-1],r.y[6,-1],r.y[7,-1]]
sollast_l, lambdaslast=maxent_reconstruct_c0_2(mu=mulast_l,bnds=bnds)

'''reconstructed distribution from comsol moments at last time step'''
mu_comsol_d = [m0c_d[-1],m1c_d[-1],m2c_d[-1],m3c_d[-1]]
mu_comsol_l = [m0c_l[-1],m1c_l[-1],m2c_l[-1],m3c_l[-1]]

sol_comsol_d, lambdas_comsol_d = maxent_reconstruct_c0_1(mu=mu_comsol_d,bnds=bnds)
sol_comsol_l, lambdas_comsol_l = maxent_reconstruct_c0_2(mu=mu_comsol_l,bnds=bnds)

L=np.linspace(0,6)
pp.plot(L,sollast_d(L),'-b,', L,sollast_l(L),'-g',L,sol_comsol_d(L),'-r,', L,sol_comsol_l(L),'-y')
pp.title('t = 20 ')
pp.xlabel('characteristic length',{"fontsize":16})
pp.ylabel('size distribution',{"fontsize":16})
pp.legend(('maxent f (D)','maxent f (L)', 'Comsol f (D)','Comsol f (L)'),loc=0)
